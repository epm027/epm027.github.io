<!DOCTYPE html>
<html lang="en"><head>
<script src="Bayes2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Bayes2_files/libs/quarto-html/tabby.min.js"></script>
<script src="Bayes2_files/libs/quarto-html/popper.min.js"></script>
<script src="Bayes2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Bayes2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Bayes2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Bayes2_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Bayes2_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Ethan Marzban">
  <title>Bayesian Techniques</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Bayes2_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Bayes2_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="Bayes2_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Bayes2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Bayes2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Bayes2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Bayes2_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Bayes2_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Bayes2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script type="module" src="Bayes2_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
  <link href="Bayes2_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="dsc.png" data-background-opacity="0.5" data-background-position="left" data-background-size="contain" class="center">
  <h1 class="title" style="text-align: right">Bayesian Techniques</h1>
  <h2 class="subtitle" style="text-align: right">A Very Brief Introduction</h2>
  <p class="author" style="text-align: right">Ethan Marzban</p>
  <p class="institute" style="text-align: right">DS Collab, Winter 2024</p>
</section>
<section class="slide level2">

<div class="hidden">
<p><span class="math display">\[
\newcommand\R{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\1}{1\!\!1}
\newcommand{\comp}[1]{#1^{\complement}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\SD}{\mathrm{SD}}
\newcommand{\vect}[1]{\vec{\boldsymbol{#1}}}
\newcommand{\Cov}{\mathrm{Cov}}
\usepackage[makeroom]{cancel}
\newcommand{\iid}{\stackrel{\mathrm{i.i.d.}}{\sim}}
\newcommand{\Lik}{\mathcal{L}}
\DeclareMathOperator*{\argmax}{\mathrm{arg max}}
\]</span></p>
</div>
</section>
<section id="gameplan" class="slide level2">
<h2>Gameplan</h2>
<ol type="1">
<li class="fragment"><p>Monte Carlo simulation methods</p></li>
<li class="fragment"><p>Intro to Bayesian Framework</p></li>
<li class="fragment"><p>MCMC</p></li>
</ol>
<ul>
<li class="fragment"><p><strong>Very</strong> brief overview; endless possibilities!</p>
<ul>
<li class="fragment">PSTAT 115</li>
</ul></li>
<li class="fragment"><p>A few prerequisites:</p>
<ul>
<li class="fragment"><p>PSTAT 120A (common distributions, random variables, probability spaces)</p></li>
<li class="fragment"><p>PSTAT 120B (likelihood-based inference, confidence intervals)</p></li>
</ul></li>
</ul>
</section>
<section>
<section id="simulation" class="title-slide slide level1 center">
<h1>Simulation</h1>

</section>
<section id="leadup" class="slide level2">
<h2>Leadup</h2>
<ul>
<li class="fragment"><p>Example Experiment: <span class="math inline">\(X, Y \iid \mathrm{Unif}\{1, \cdots, 100\}\)</span>, and suppose we want to compute <span class="math inline">\(\Prob(X \leq Y)\)</span>.</p></li>
<li class="fragment"><p>Let’s do this on the board. (Final answer: 101/200)</p></li>
<li class="fragment"><p>We could, however, compute this using a <span style="color:#fa8b2f"><strong>simulation</strong></span>:</p></li>
</ul>
<div class="cell">
<style type="text/css">
.big-code{
  font-size: 130%
}
</style>
</div>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">set.seed</span>(<span class="dv">27</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, B, <span class="at">replace =</span> T)</span>
<span id="cb1-5"><a href="#cb1-5"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, B, <span class="at">replace =</span> T)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">sum</span>(x <span class="sc">&lt;=</span> y) <span class="sc">/</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.531</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="leadup-1" class="slide level2">
<h2>Leadup</h2>
<ul>
<li class="fragment"><p>Might not seem all that interesting.</p></li>
<li class="fragment"><p>But, suppose instead <span class="math inline">\(X, Y, Z \iid \mathrm{Unif}\{1, \cdots, 100\}\)</span>, and suppose we want to compute <span class="math inline">\(\Prob(X \leq Y \leq Z)\)</span>.</p></li>
<li class="fragment"><p>Computing this by hand becomes a bit more challenging.</p></li>
<li class="fragment"><p>Updating our simulation, though, is easy:</p></li>
</ul>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">set.seed</span>(<span class="dv">27</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, B, <span class="at">replace =</span> T)</span>
<span id="cb3-5"><a href="#cb3-5"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, B, <span class="at">replace =</span> T)</span>
<span id="cb3-6"><a href="#cb3-6"></a>z <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, B, <span class="at">replace =</span> T)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="fu">sum</span>((x <span class="sc">&lt;=</span> y) <span class="sc">&amp;</span> (y <span class="sc">&lt;=</span> z)) <span class="sc">/</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.182</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="monte-carlo-simulation" class="slide level2">
<h2>Monte Carlo Simulation</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Theorem 1: Monte Carlo, version 1</strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(A\)</span> be an event with probability of occurrence <span class="math inline">\(\Prob(A)\)</span>. Let <span class="math inline">\(Y_n\)</span> be defined as the proportion of times the event <span class="math inline">\(A\)</span> occurs in <span class="math inline">\(n\)</span> repetitions of the underlying experiment: then <span class="math inline">\(Y_n\)</span> converges to <span class="math inline">\(\Prob(A)\)</span> in probability: <span class="math display">\[ Y_n \stackrel{p}{\longrightarrow} \Prob(A) \]</span></p>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>Colloquially: proportion of times <span class="math inline">\(A\)</span> happens in <span class="math inline">\(n\)</span> repetitions is a good approximation for <span class="math inline">\(\Prob(A)\)</span>, provided <span class="math inline">\(n\)</span> is large.</p></li>
<li class="fragment"><p>Proof is simple; I’ll leave it in an appendix.</p>
<ul>
<li class="fragment">Uses the <span style="color:#fa8b2f"><strong>Weak Law of Large Numbers</strong></span> (WLLN)</li>
</ul></li>
</ul>
</section>
<section id="monte-carlo-integration" class="slide level2">
<h2>Monte Carlo Integration</h2>
<ul>
<li class="fragment"><p>Some probabilities can be written as integrals.</p></li>
<li class="fragment"><p>Hence, Monte Carlo Simulation can help approximate integrals.</p></li>
<li class="fragment"><p>E.g. say we want to compute <span class="math display">\[ I_1 := \frac{1}{\sqrt{2\pi}} \int_{0}^{1} e^{-x^2 / 2} \ \mathrm{d}x \]</span></p></li>
<li class="fragment"><p>If <span class="math inline">\(X \sim \mathcal{N}(0, 1)\)</span>, then <span class="math inline">\(I_1 = \Prob(0 \leq X \leq 1)\)</span>.</p></li>
<li class="fragment"><p>So, simulate a bunch of <span class="math inline">\(\mathcal{N}(0, 1)\)</span> draws and compute the proportion that are between 0 and 1.</p></li>
</ul>
</section>
<section id="monte-carlo-integration-1" class="slide level2">
<h2>Monte Carlo Integration</h2>
<ul>
<li class="fragment">Simulation:</li>
</ul>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5000</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">ifelse</span>((X <span class="sc">&gt;=</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (X <span class="sc">&lt;=</span> <span class="dv">1</span>), <span class="dv">1</span>, <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3414</code></pre>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">True Answer:</li>
</ul>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">integrate</span>(dnorm, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3413447 with absolute error &lt; 3.8e-15</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="monte-carlo-integration-2" class="slide level2">
<h2>Monte Carlo Integration</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Monte Carlo, version 2</strong></p>
</div>
<div class="callout-content">
<p>Consider evaluating the integral <span class="math display">\[ I(f) := \int_{0}^{1} f(x) \ \mathrm{d}x \]</span> Let <span class="math inline">\(X_1, \cdots, X_n\)</span> denote an i.i.d. sample from the <span class="math inline">\(\mathrm{Unif}[0, 1]\)</span> distribution. Then, <span class="math display">\[ \widehat{I}(f) := \frac{1}{n} \sum_{i=1}^{n} f(X_i)  \stackrel{p}{\longrightarrow} I(f) \]</span></p>
</div>
</div>
</div>
</section>
<section id="monte-carlo-integration-3" class="slide level2">
<h2>Monte Carlo Integration</h2>
<ul>
<li class="fragment"><p>General procedure to approximate <span class="math inline">\(I(f) := \int_{a}^{b} f(x) \ \mathrm{d}x\)</span>:</p>
<ol type="1">
<li class="fragment"><p>Generate <span class="math inline">\(X_1, \cdots, X_n \iid \mathrm{Unif}[0, 1]\)</span></p></li>
<li class="fragment"><p>Evaluate <span class="math inline">\(\widehat{I}(f) := n^{-1} \sum_{i=1}^{n} f(X_i)\)</span></p></li>
</ol></li>
<li class="fragment"><p>Example:</p></li>
</ul>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>B <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(B)</span>
<span id="cb9-4"><a href="#cb9-4"></a>(<span class="dv">1</span><span class="sc">/</span>B) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)) <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3417681</code></pre>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">True Answer: 0.3413447</li>
</ul>
</section>
<section id="moral" class="slide level2">
<h2>Moral</h2>
<ul>
<li class="fragment">We can use <em>sampling</em> to help us compute probabilistic quantities.</li>
</ul>
</section></section>
<section>
<section id="intro-to-the-bayesian-framework" class="title-slide slide level1 center">
<h1>Intro to the Bayesian Framework</h1>

</section>
<section id="philosophy" class="slide level2">
<h2>Philosophy</h2>
<ul>
<li class="fragment"><p>For an event <span class="math inline">\(A\)</span>, what does <span class="math inline">\(\Prob(A)\)</span> represent?</p>
<ul>
<li class="fragment"><em>Beliefs</em>, on the event <span class="math inline">\(A\)</span>.</li>
</ul></li>
<li class="fragment"><p>Typical approach (like in 120A): <span style="color:#fa8b2f"><strong>Long-Run Frequency</strong></span> approach, which <em>defines</em> <span class="math inline">\(\Prob(A)\)</span> to be <span class="math display">\[ \lim_{n \to \infty} \left( \frac{\text{\# times $A$ occurs in $n$ repetitions}}{n} \right)\]</span></p>
<ul>
<li class="fragment"><p>Based on the notion of <em>infinite repetitions</em> and <em>frequencies</em>.</p></li>
<li class="fragment"><p>Kind of nonsensical!</p></li>
</ul></li>
</ul>
</section>
<section id="philosophy-1" class="slide level2">
<h2>Philosophy</h2>
<ul>
<li class="fragment"><p>Example (due to <a href="https://www.bayesrulesbook.com/chapter-1">this</a> source): in an upcoming election, a pollster claims that candidate <span class="math inline">\(A\)</span> has a <span class="math inline">\(0.9\)</span> chance of winning.</p>
<ul>
<li class="fragment"><p>Seems like a reasonable enough statement.</p></li>
<li class="fragment"><p>But, from a true frequentist perspective, <em>this cannot be!</em></p>
<ul>
<li class="fragment">Infinite repetitions are impossible</li>
</ul></li>
<li class="fragment"><p>Rather, <span class="math inline">\(\Prob(\text{$A$ wins}) = 0.9\)</span> is a statement about <em>prior beliefs</em>, beliefs we hold prior to starting our experiment.</p></li>
</ul></li>
<li class="fragment"><p>So, idea: modify our framework to allow to explicit incorporation of <span style="color:#fa8b2f"><strong>prior beliefs</strong></span>, which in turn will allow us to explicitly <em>update</em> our beliefs in the presence of new information.</p></li>
</ul>
</section>
<section id="bayesian-ingredients" class="slide level2">
<h2>Bayesian Ingredients</h2>
<ul>
<li class="fragment"><p>3 main steps in Bayesian analysis (according to Dr.&nbsp;Andrew Gelman):</p>
<ol type="1">
<li class="fragment"><p>Set up a full probability model</p></li>
<li class="fragment"><p>Condition on observed data</p></li>
<li class="fragment"><p>Evaluate model fit, and adjust/repeat as necessary</p></li>
</ol></li>
<li class="fragment"><p>Before diving in too deep, let’s recap the <span style="color:#fa8b2f"><strong>frequentist</strong></span> way of thinking; specifically, let’s review <span style="color:#fa8b2f"><strong>likelihood-based methods</strong></span></p></li>
</ul>
</section>
<section id="recap-of-likelihood-based-methods" class="slide level2">
<h2>Recap of Likelihood-Based Methods</h2>
<ul>
<li class="fragment"><p>Consider frequentist treatment: <span class="math inline">\(X_1, \cdots, X_n \iid p(x; \theta)\)</span></p>
<ul>
<li class="fragment">Notation means “draw from some known distribution with density/mass function <span class="math inline">\(p(\cdot)\)</span> and parameter(s) <span class="math inline">\(\theta\)</span>.”</li>
</ul></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Likelihood</strong></span>: given observations <span class="math inline">\(X_1 = x_1, \ \cdots, X_n = x_n\)</span>, how likely are we to observe a value <span class="math inline">\(\theta_0\)</span> of <span class="math inline">\(\theta\)</span>?</p>
<ul>
<li class="fragment">Mathematically: joint density <span class="math display">\[\begin{align*}
  \Lik_{\vect{x}}(\theta_0)    &amp;   = p_{X_1, \cdots, X_n}(x_1, \cdots, x_n ; \theta_0)   \\
&amp; = \prod_{i=1}^{n} p(x_i; \theta_0)
\end{align*}\]</span></li>
</ul></li>
</ul>
</section>
<section id="quick-example" class="slide level2">
<h2>Quick Example</h2>
<ul>
<li class="fragment"><p><span class="math inline">\(X_1, \cdots, X_n \iid \mathcal{N}(\mu, 1)\)</span>.<br>
</p></li>
<li class="fragment"><p><span class="math inline">\(\begin{aligned}[t] \Lik_{\vect{x}}(\mu) &amp; = f_{X_1, \cdots, X_n}(x_1, \cdots, x_n ; \mu) \\ &amp; = \prod_{i=1}^{n} \left[ \frac{1}{\sqrt{2\pi}} \exp\left\{ - \frac{1}{2} (x_i - \mu)^2 \right\} \\ \right] \\ &amp; = \frac{1}{\sqrt{2\pi}} \exp\left\{ -\frac{1}{2} \sum_{i=1}^{n} (x_i - \mu)^2 \right\} \end{aligned}\)</span></p></li>
</ul>
</section>
<section id="transition-to-bayesian" class="slide level2">
<h2>Transition to Bayesian</h2>
<ul>
<li class="fragment"><p>Key point: <span class="math inline">\(\theta\)</span> is unknown, but assumed to be deterministic.</p>
<ul>
<li class="fragment">120B seeks to (among other things) develop <span style="color:#fa8b2f"><strong>estimators</strong></span> <span class="math inline">\(\widehat{\theta}_n\)</span> of <span class="math inline">\(\theta\)</span>, that satisfy certain properties (e.g.&nbsp;unbiasedness, consistency, UMVUE, etc.)</li>
</ul></li>
<li class="fragment"><p>Bayesian framework, instead, allows for incorporation of prior information by treating <span class="math inline">\(\theta\)</span> as <em>random</em>, with some <span style="color:#fa8b2f"><strong>prior distribution</strong></span> <span class="math inline">\(\pi(\theta)\)</span>.</p>
<ul>
<li class="fragment">Remember: we’re trying to allow for a more explicit incorporation of <em>prior beliefs</em>!</li>
</ul></li>
</ul>
</section>
<section id="transition-to-bayesian-1" class="slide level2">
<h2>Transition to Bayesian</h2>
<ul>
<li class="fragment"><p>Not all that removed from reality!</p></li>
<li class="fragment"><p>E.g.: consider counting the number <span class="math inline">\(N\)</span> of diseased trees in a forest.</p>
<ul>
<li class="fragment"><p>Assuming a fixed rate <span class="math inline">\(\lambda\)</span> of diseased trees per square foot, <span class="math inline">\(N \sim \mathrm{Pois}(\lambda)\)</span>.</p></li>
<li class="fragment"><p>But, in reality, rate of diseased trees may vary. Better to instead let the rate <span class="math inline">\(\Lambda\)</span> vary according to a distribution (e.g.&nbsp;Exponential, etc.)</p></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="interlude-distributions" class="title-slide slide level1 center">
<h1>Interlude: Distributions</h1>

</section>
<section id="gamma-distribution" class="slide level2">
<h2>Gamma Distribution</h2>
<ul>
<li class="fragment"><p><strong>Notation:</strong> <span class="math inline">\(X \sim \mathrm{Gamma}(\alpha, \beta)\)</span></p></li>
<li class="fragment"><p><strong>PDF</strong>: <span class="math inline">\(f_X(x) = \frac{1}{\Gamma(\alpha) \beta^\alpha} \cdot x^{\alpha - 1} \cdot e^{-x/\beta} \cdot \1_{\{x \geq 0\}}\)</span></p>
<ul>
<li class="fragment"><span class="math inline">\(\Gamma(r) := \int_{-\infty}^{\infty} t^{r - 1} e^{-t} \ \mathrm{d}t\)</span> if <span class="math inline">\(r &gt; 0\)</span></li>
</ul></li>
<li class="fragment"><p><strong>Expectation and Variance:</strong> <span class="math inline">\(\E[X] = \alpha \beta; \quad \Var(X) = \alpha \beta^2\)</span></p></li>
<li class="fragment"><p><strong>MGF:</strong> <span class="math inline">\(M_X(t) = \begin{cases} (1 - \beta t)^{-\alpha} &amp; \text{if } t &lt; 1/\beta \\ \infty &amp; \text{otherwise} \\ \end{cases}\)</span></p></li>
<li class="fragment"><p><strong>CDF:</strong> No simple closed-form expression in general.</p></li>
</ul>
</section>
<section id="gamma-distribution-1" class="slide level2">
<h2>Gamma Distribution</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="310" data-source-offset="-0"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 309;"><span id="cb11-310"><a href="#cb11-310"></a>viewof alpha_2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb11-311"><a href="#cb11-311"></a>  [<span class="fl">0.1</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> </span>
<span id="cb11-312"><a href="#cb11-312"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="fl">1.5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"alpha = "</span>}</span>
<span id="cb11-313"><a href="#cb11-313"></a>)</span>
<span id="cb11-314"><a href="#cb11-314"></a></span>
<span id="cb11-315"><a href="#cb11-315"></a>viewof beta_2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb11-316"><a href="#cb11-316"></a>  [<span class="fl">0.1</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> </span>
<span id="cb11-317"><a href="#cb11-317"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"beta = "</span>}</span>
<span id="cb11-318"><a href="#cb11-318"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="323" data-source-offset="-1"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 322;"><span id="cb12-323"><a href="#cb12-323"></a>margin <span class="op">=</span> ({<span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">40</span>})</span>
<span id="cb12-324"><a href="#cb12-324"></a></span>
<span id="cb12-325"><a href="#cb12-325"></a>height <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb12-326"><a href="#cb12-326"></a></span>
<span id="cb12-327"><a href="#cb12-327"></a>x_values_2 <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb12-328"><a href="#cb12-328"></a>    <span class="op">.</span><span class="fu">domain</span>(d3<span class="op">.</span><span class="fu">extent</span>(data_2<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>))</span>
<span id="cb12-329"><a href="#cb12-329"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])</span>
<span id="cb12-330"><a href="#cb12-330"></a></span>
<span id="cb12-331"><a href="#cb12-331"></a>y_values_2 <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb12-332"><a href="#cb12-332"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(data_2<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>)<span class="op">,</span><span class="dv">0</span>)<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span><span class="op">,</span>d3<span class="op">.</span><span class="fu">max</span>(data_2<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>))])<span class="op">.</span><span class="fu">nice</span>()</span>
<span id="cb12-333"><a href="#cb12-333"></a>    <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])</span>
<span id="cb12-334"><a href="#cb12-334"></a>    </span>
<span id="cb12-335"><a href="#cb12-335"></a>line_2 <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb12-336"><a href="#cb12-336"></a>    <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> <span class="fu">x_values_2</span>(d<span class="op">.</span><span class="at">x</span>))</span>
<span id="cb12-337"><a href="#cb12-337"></a>    <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> <span class="fu">y_values_2</span>(d<span class="op">.</span><span class="at">y</span>))</span>
<span id="cb12-338"><a href="#cb12-338"></a></span>
<span id="cb12-339"><a href="#cb12-339"></a>xAxis_2 <span class="op">=</span> g <span class="kw">=&gt;</span> g</span>
<span id="cb12-340"><a href="#cb12-340"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0,</span><span class="sc">${</span>height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb12-341"><a href="#cb12-341"></a>  <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisBottom</span>(x_values_2)</span>
<span id="cb12-342"><a href="#cb12-342"></a>      <span class="op">.</span><span class="fu">ticks</span>(width <span class="op">/</span> <span class="dv">80</span>)</span>
<span id="cb12-343"><a href="#cb12-343"></a>      <span class="op">.</span><span class="fu">tickSizeOuter</span>(<span class="dv">0</span>))</span>
<span id="cb12-344"><a href="#cb12-344"></a></span>
<span id="cb12-345"><a href="#cb12-345"></a>yAxis_2 <span class="op">=</span> g <span class="kw">=&gt;</span> g</span>
<span id="cb12-346"><a href="#cb12-346"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb12-347"><a href="#cb12-347"></a>  <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(y_values_2)</span>
<span id="cb12-348"><a href="#cb12-348"></a>      <span class="op">.</span><span class="fu">tickValues</span>(d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>(y_values_2<span class="op">.</span><span class="fu">domain</span>())<span class="op">.</span><span class="fu">ticks</span>()))</span>
<span id="cb12-349"><a href="#cb12-349"></a></span>
<span id="cb12-350"><a href="#cb12-350"></a>mathfn <span class="op">=</span> <span class="pp">require</span>(<span class="st">'https://bundle.run/mathfn@1.1.0'</span>)</span>
<span id="cb12-351"><a href="#cb12-351"></a></span>
<span id="cb12-352"><a href="#cb12-352"></a>abs_x<span class="op">=</span><span class="dv">6</span></span>
<span id="cb12-353"><a href="#cb12-353"></a></span>
<span id="cb12-354"><a href="#cb12-354"></a><span class="kw">function</span> <span class="fu">gamma_pdf</span> (input_value<span class="op">,</span> alpha<span class="op">,</span> beta) {</span>
<span id="cb12-355"><a href="#cb12-355"></a>  <span class="cf">if</span>(input_value <span class="op">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb12-356"><a href="#cb12-356"></a>    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb12-357"><a href="#cb12-357"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-358"><a href="#cb12-358"></a>    <span class="kw">let</span> left_const <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(mathfn<span class="op">.</span><span class="fu">gamma</span>(beta_2) <span class="op">*</span> beta_2<span class="op">**</span>alpha_2)</span>
<span id="cb12-359"><a href="#cb12-359"></a>    <span class="kw">let</span> mid_var <span class="op">=</span> input_value<span class="op">**</span>(alpha_2 <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb12-360"><a href="#cb12-360"></a>    <span class="kw">let</span> right_var <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>input_value<span class="op">/</span>beta_2)</span>
<span id="cb12-361"><a href="#cb12-361"></a>    <span class="cf">return</span> left_const <span class="op">*</span> mid_var <span class="op">*</span> right_var</span>
<span id="cb12-362"><a href="#cb12-362"></a>  }</span>
<span id="cb12-363"><a href="#cb12-363"></a>}</span>
<span id="cb12-364"><a href="#cb12-364"></a></span>
<span id="cb12-365"><a href="#cb12-365"></a>data_2 <span class="op">=</span> {</span>
<span id="cb12-366"><a href="#cb12-366"></a>  <span class="kw">let</span> values <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb12-367"><a href="#cb12-367"></a>  <span class="cf">for</span> (<span class="kw">let</span> x <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">;</span> x <span class="op">&lt;</span> abs_x<span class="op">;</span> x<span class="op">=</span>x<span class="op">+</span><span class="fl">0.01</span>) values<span class="op">.</span><span class="fu">push</span>({<span class="st">"x"</span><span class="op">:</span>x<span class="op">,</span><span class="st">"y"</span><span class="op">:</span><span class="fu">gamma_pdf</span>(x<span class="op">,</span> alpha_2<span class="op">,</span> beta_2)})<span class="op">;</span></span>
<span id="cb12-368"><a href="#cb12-368"></a>  <span class="cf">return</span> values<span class="op">;</span></span>
<span id="cb12-369"><a href="#cb12-369"></a>}</span>
<span id="cb12-370"><a href="#cb12-370"></a></span>
<span id="cb12-371"><a href="#cb12-371"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"https://d3js.org/d3.v5.min.js"</span>)</span>
<span id="cb12-372"><a href="#cb12-372"></a></span>
<span id="cb12-373"><a href="#cb12-373"></a>chart_2 <span class="op">=</span> {</span>
<span id="cb12-374"><a href="#cb12-374"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(width<span class="op">,</span> height))<span class="op">;</span></span>
<span id="cb12-375"><a href="#cb12-375"></a></span>
<span id="cb12-376"><a href="#cb12-376"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb12-377"><a href="#cb12-377"></a>      <span class="op">.</span><span class="fu">call</span>(xAxis_2)<span class="op">;</span></span>
<span id="cb12-378"><a href="#cb12-378"></a></span>
<span id="cb12-379"><a href="#cb12-379"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb12-380"><a href="#cb12-380"></a>      <span class="op">.</span><span class="fu">call</span>(yAxis_2)<span class="op">;</span></span>
<span id="cb12-381"><a href="#cb12-381"></a>  </span>
<span id="cb12-382"><a href="#cb12-382"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb12-383"><a href="#cb12-383"></a>      <span class="op">.</span><span class="fu">datum</span>(data_2)</span>
<span id="cb12-384"><a href="#cb12-384"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb12-385"><a href="#cb12-385"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#fa8b2f"</span>)</span>
<span id="cb12-386"><a href="#cb12-386"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb12-387"><a href="#cb12-387"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linejoin"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb12-388"><a href="#cb12-388"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linecap"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb12-389"><a href="#cb12-389"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> line_2)<span class="op">;</span></span>
<span id="cb12-390"><a href="#cb12-390"></a>  </span>
<span id="cb12-391"><a href="#cb12-391"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb12-392"><a href="#cb12-392"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-13" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div style="font-size:18px; text-align:right">
<p><em>Credit to https://observablehq.com/<span class="citation" data-cites="dswalter/normal-distribution">@dswalter/normal-distribution</span> for the base of the original applet code</em></p>
</div>
</section>
<section id="beta-distribution" class="slide level2">
<h2>Beta Distribution</h2>
<ul>
<li class="fragment"><p><strong>Notation:</strong> <span class="math inline">\(X \sim \mathrm{Beta}(\alpha, \beta)\)</span></p></li>
<li class="fragment"><p><strong>PDF</strong>: <span class="math inline">\(f_X(x) = \frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha) \Gamma(\beta)} \cdot x^{\alpha - 1} \cdot (1 - x)^{\beta - 1} \cdot \1_{\{0 \leq x \leq 1\}}\)</span></p></li>
<li class="fragment"><p><strong>Expectation and Variance:</strong> <span class="math inline">\(\E[X] = \frac{\alpha}{\alpha + \beta}; \quad \Var(X) = \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)}\)</span></p></li>
<li class="fragment"><p><strong>MGF:</strong> No simple closed-form in general.</p></li>
<li class="fragment"><p><strong>CDF:</strong> No simple closed-form in general.</p></li>
</ul>
</section>
<section id="beta-distribution-1" class="slide level2">
<h2>Beta Distribution</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="416" data-source-offset="-0"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 415;"><span id="cb13-416"><a href="#cb13-416"></a>viewof alpha_3 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb13-417"><a href="#cb13-417"></a>  [<span class="dv">0</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> </span>
<span id="cb13-418"><a href="#cb13-418"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"alpha = "</span>}</span>
<span id="cb13-419"><a href="#cb13-419"></a>)</span>
<span id="cb13-420"><a href="#cb13-420"></a></span>
<span id="cb13-421"><a href="#cb13-421"></a>viewof beta_3 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb13-422"><a href="#cb13-422"></a>  [<span class="dv">0</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> </span>
<span id="cb13-423"><a href="#cb13-423"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"beta = "</span>}</span>
<span id="cb13-424"><a href="#cb13-424"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="429" data-source-offset="-1"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 428;"><span id="cb14-429"><a href="#cb14-429"></a>width <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb14-430"><a href="#cb14-430"></a></span>
<span id="cb14-431"><a href="#cb14-431"></a>x_values_5 <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb14-432"><a href="#cb14-432"></a>    <span class="op">.</span><span class="fu">domain</span>(d3<span class="op">.</span><span class="fu">extent</span>(data_5<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>))</span>
<span id="cb14-433"><a href="#cb14-433"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])</span>
<span id="cb14-434"><a href="#cb14-434"></a></span>
<span id="cb14-435"><a href="#cb14-435"></a>y_values_5 <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb14-436"><a href="#cb14-436"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(data_5<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>)<span class="op">,</span><span class="dv">0</span>)<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span><span class="op">,</span>d3<span class="op">.</span><span class="fu">max</span>(data_5<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>))])<span class="op">.</span><span class="fu">nice</span>()</span>
<span id="cb14-437"><a href="#cb14-437"></a>    <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])</span>
<span id="cb14-438"><a href="#cb14-438"></a>    </span>
<span id="cb14-439"><a href="#cb14-439"></a>line_5 <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb14-440"><a href="#cb14-440"></a>    <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> <span class="fu">x_values_5</span>(d<span class="op">.</span><span class="at">x</span>))</span>
<span id="cb14-441"><a href="#cb14-441"></a>    <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> <span class="fu">y_values_5</span>(d<span class="op">.</span><span class="at">y</span>))</span>
<span id="cb14-442"><a href="#cb14-442"></a></span>
<span id="cb14-443"><a href="#cb14-443"></a>xAxis_5 <span class="op">=</span> g <span class="kw">=&gt;</span> g</span>
<span id="cb14-444"><a href="#cb14-444"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0,</span><span class="sc">${</span>height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb14-445"><a href="#cb14-445"></a>  <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisBottom</span>(x_values_5)</span>
<span id="cb14-446"><a href="#cb14-446"></a>      <span class="op">.</span><span class="fu">ticks</span>(width <span class="op">/</span> <span class="dv">80</span>)</span>
<span id="cb14-447"><a href="#cb14-447"></a>      <span class="op">.</span><span class="fu">tickSizeOuter</span>(<span class="dv">0</span>))</span>
<span id="cb14-448"><a href="#cb14-448"></a></span>
<span id="cb14-449"><a href="#cb14-449"></a>yAxis_5 <span class="op">=</span> g <span class="kw">=&gt;</span> g</span>
<span id="cb14-450"><a href="#cb14-450"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb14-451"><a href="#cb14-451"></a>  <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(y_values_5)</span>
<span id="cb14-452"><a href="#cb14-452"></a>      <span class="op">.</span><span class="fu">tickValues</span>(d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>(y_values_5<span class="op">.</span><span class="fu">domain</span>())<span class="op">.</span><span class="fu">ticks</span>()))</span>
<span id="cb14-453"><a href="#cb14-453"></a></span>
<span id="cb14-454"><a href="#cb14-454"></a><span class="kw">function</span> <span class="fu">beta_pdf</span> (input_value<span class="op">,</span> alpha<span class="op">,</span> beta) {</span>
<span id="cb14-455"><a href="#cb14-455"></a>  <span class="cf">if</span>(input_value <span class="op">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb14-456"><a href="#cb14-456"></a>    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb14-457"><a href="#cb14-457"></a>  } <span class="cf">else</span> <span class="cf">if</span>(input_value <span class="op">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb14-458"><a href="#cb14-458"></a>    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb14-459"><a href="#cb14-459"></a>  } <span class="cf">else</span> {</span>
<span id="cb14-460"><a href="#cb14-460"></a>    <span class="kw">let</span> const1 <span class="op">=</span> mathfn<span class="op">.</span><span class="fu">beta</span>(alpha<span class="op">,</span> beta)</span>
<span id="cb14-461"><a href="#cb14-461"></a>    <span class="kw">let</span> var1 <span class="op">=</span> input_value<span class="op">**</span>(alpha <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb14-462"><a href="#cb14-462"></a>    <span class="kw">let</span> var2 <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> input_value)<span class="op">**</span>(beta <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb14-463"><a href="#cb14-463"></a>    <span class="cf">return</span> (<span class="dv">1</span><span class="op">/</span>const1) <span class="op">*</span> var1 <span class="op">*</span> var2</span>
<span id="cb14-464"><a href="#cb14-464"></a>  }</span>
<span id="cb14-465"><a href="#cb14-465"></a>}</span>
<span id="cb14-466"><a href="#cb14-466"></a></span>
<span id="cb14-467"><a href="#cb14-467"></a>data_5 <span class="op">=</span> {</span>
<span id="cb14-468"><a href="#cb14-468"></a>  <span class="kw">let</span> values <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb14-469"><a href="#cb14-469"></a>  <span class="cf">for</span> (<span class="kw">let</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> x <span class="op">&lt;</span> <span class="dv">1</span><span class="op">;</span> x<span class="op">=</span>x<span class="op">+</span><span class="fl">0.01</span>) values<span class="op">.</span><span class="fu">push</span>({<span class="st">"x"</span><span class="op">:</span>x<span class="op">,</span><span class="st">"y"</span><span class="op">:</span><span class="fu">beta_pdf</span>(x<span class="op">,</span> alpha_3<span class="op">,</span> beta_3)})<span class="op">;</span></span>
<span id="cb14-470"><a href="#cb14-470"></a>  <span class="cf">return</span> values<span class="op">;</span></span>
<span id="cb14-471"><a href="#cb14-471"></a>}</span>
<span id="cb14-472"><a href="#cb14-472"></a></span>
<span id="cb14-473"><a href="#cb14-473"></a>chart_5 <span class="op">=</span> {</span>
<span id="cb14-474"><a href="#cb14-474"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(width<span class="op">,</span> height))<span class="op">;</span></span>
<span id="cb14-475"><a href="#cb14-475"></a></span>
<span id="cb14-476"><a href="#cb14-476"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb14-477"><a href="#cb14-477"></a>      <span class="op">.</span><span class="fu">call</span>(xAxis_5)<span class="op">;</span></span>
<span id="cb14-478"><a href="#cb14-478"></a></span>
<span id="cb14-479"><a href="#cb14-479"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb14-480"><a href="#cb14-480"></a>      <span class="op">.</span><span class="fu">call</span>(yAxis_5)<span class="op">;</span></span>
<span id="cb14-481"><a href="#cb14-481"></a>  </span>
<span id="cb14-482"><a href="#cb14-482"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb14-483"><a href="#cb14-483"></a>      <span class="op">.</span><span class="fu">datum</span>(data_5)</span>
<span id="cb14-484"><a href="#cb14-484"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb14-485"><a href="#cb14-485"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#fa8b2f"</span>)</span>
<span id="cb14-486"><a href="#cb14-486"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb14-487"><a href="#cb14-487"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linejoin"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb14-488"><a href="#cb14-488"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linecap"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb14-489"><a href="#cb14-489"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> line_5)<span class="op">;</span></span>
<span id="cb14-490"><a href="#cb14-490"></a>  </span>
<span id="cb14-491"><a href="#cb14-491"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb14-492"><a href="#cb14-492"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-9" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div style="font-size:18px; text-align:right">
<p><em>Credit to https://observablehq.com/<span class="citation" data-cites="dswalter/normal-distribution">@dswalter/normal-distribution</span> for the base of the original applet code</em></p>
</div>
</section>
<section id="densities" class="slide level2">
<h2>Densities</h2>
<ul>
<li class="fragment"><p>Densities are of the form <span class="math inline">\(f(x; \theta) = c(\theta) \cdot k(x; \theta)\)</span> where <em>c</em> is a constant independent of <span class="math inline">\(x\)</span> (but potentially involving parameters).</p></li>
<li class="fragment"><p>Key point: <em>c</em> is a <em>normalizing constant</em> (i.e.&nbsp;a term that ensures the density integrates to 1), and is thus uniquely determined by <span class="math inline">\(k(x; \theta)\)</span></p></li>
<li class="fragment"><p>In other words: <span style="color:#fa8b2f"><strong>variable part</strong></span> <span class="math inline">\(k(x; \theta)\)</span> of the density is enough to determine distribution.</p></li>
</ul>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<ul>
<li class="fragment"><p>For instance, say <span class="math inline">\(X \sim f(x; \mu) \propto e^{-(x - \mu)^2}\)</span>.</p>
<ul>
<li class="fragment"><p>Already know that <span class="math inline">\(X \sim \mathcal{N}(\mu, 1/2)\)</span>, since <span class="math display">\[k(x; \mu) = e^{-\frac{1}{2(1/2)}(x - \mu)^2}\]</span> which is the variable portion (kernel) of the <span class="math inline">\(\mathcal{N}(\mu, 1/2)\)</span> distribution.</p></li>
<li class="fragment"><p>Key point: don’t need to know value of normalizing constant!</p></li>
</ul></li>
<li class="fragment"><p>Second Example: <span class="math inline">\(Y \sim f(y) \propto y\sqrt{1 - y} \cdot \1_{\{x \in [0, 1]\}}\)</span>. What distribution does <span class="math inline">\(Y\)</span> follow?</p></li>
</ul>
</section></section>
<section>
<section id="bayesian-modeling" class="title-slide slide level1 center">
<h1>Bayesian Modeling</h1>

</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<ul>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Model</strong></span> (aka <span style="color:#fa8b2f"><strong>Sampling Distribution</strong></span>): <span class="math inline">\(p(y \mid \theta)\)</span></p>
<ul>
<li class="fragment"><p><span class="math inline">\(y\)</span> is data; <span class="math inline">\(\theta\)</span> is the parameter</p></li>
<li class="fragment"><p>This is just the familiar likelihood</p></li>
</ul></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Prior</strong></span>: <span class="math inline">\(\pi(\theta)\)</span>, a distributional assertion on <span class="math inline">\(\theta\)</span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Posterior</strong></span>: <span class="math inline">\(p(\theta \mid y)\)</span></p>
<ul>
<li class="fragment">Beliefs on <span class="math inline">\(\theta\)</span>, updated to reflect data <span class="math inline">\(y\)</span>.</li>
</ul></li>
</ul>
</section>
<section id="introduction-1" class="slide level2" style="font-size:33px">
<h2>Introduction</h2>
<ul>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Bayes’ Rule</strong></span>: <span class="math inline">\(\displaystyle p(\theta \mid y) = \frac{p(y \mid \theta) \cdot \pi(\theta)}{p(y)}\)</span></p></li>
<li class="fragment"><p>Note: in <span class="math inline">\(\pi(\theta \mid y)\)</span>, the variable is <span class="math inline">\(\theta\)</span>. Hence, <span class="math inline">\(p(y)\)</span> is part of the normalizing constant and is somewhat obsolete in identifying the distribution of <span class="math inline">\((\theta \mid y)\)</span>.</p>
<ul>
<li class="fragment">Recall our discussion on the variable part of a density, from a few slides ago.</li>
</ul></li>
<li class="fragment"><p>Hence, in Bayesian statistics, we often write <span class="math display">\[ p(\theta \mid y) \propto p(y \mid \theta) \cdot \pi(\theta) \]</span> i.e.&nbsp;<span class="math display">\[ \text{posterior} \propto \text{likelihood} \cdot \text{prior} \]</span></p></li>
</ul>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example 1</strong></p>
</div>
<div class="callout-content">
<p>Suppose we toss a coin <span class="math inline">\(10\)</span> times. Let <span class="math inline">\(X\)</span> denote the number of heads that we observe; assume that the probability of heads on any given trial is <span class="math inline">\(\Theta\)</span>.<br>
</p>
<p>In the absence of any information, we may set our prior on <span class="math inline">\(\theta\)</span> to be centered at <span class="math inline">\(1/2\)</span>; for now, take <span class="math inline">\(\Theta \sim \mathrm{Beta}(2, 2)\)</span>.<br>
</p>
<p>Assuming we observe 9 heads in our 10 tosses, find the posterior distribution <span class="math inline">\((\Theta \mid X = 8)\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="example-2" class="slide level2">
<h2>Example</h2>
<ul>
<li class="fragment"><p>Likelihood: <span class="math inline">\(p(x \mid \theta) = \binom{10}{x} \theta^x (1 - \theta)^{10 - x}\)</span>.</p></li>
<li class="fragment"><p>Prior: <span class="math inline">\(\pi(\theta) = 6 \theta(1 - \theta) \1_{\{0 \leq \theta \leq 1\}}\)</span></p></li>
<li class="fragment"><p>Posterior: let’s do it on the board.</p></li>
</ul>
</section>
<section id="result" class="slide level2" style="font-size:33px">
<h2>Result</h2>
<ul>
<li class="fragment"><p>In general: <span class="math display">\[\begin{align*}
(X \mid \Theta = \theta) &amp; \sim \mathrm{Bin}(n, \theta) \\ \Theta &amp; \sim \mathrm{Beta}(r, s) \\ \implies (\Theta \mid X = x) &amp; \sim \mathrm{Beta}(x + r \ , \ n - x + s)
\end{align*}\]</span></p></li>
<li class="fragment"><p>Notice that the prior and posterior belong to the same distributional family (i.e.&nbsp;Beta).</p></li>
<li class="fragment"><p>This is an example of what is known as <span style="color:#fa8b2f"><strong>conjugacy</strong></span>.</p>
<ul>
<li class="fragment">Specifically, in this example we showed that the Beta distribution is a conjugate prior for a Binomial likelihood (sometimes stated as “the Beta and Binomial distributions are in conjugacy”).</li>
</ul></li>
</ul>
</section>
<section id="common-conjugate-pairs" class="slide level2">
<h2>Common Conjugate Pairs</h2>
<p><br>
</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Likelihood</th>
<th style="text-align: center;">Conjugate Prior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Binomial</td>
<td style="text-align: center;">Beta</td>
</tr>
<tr class="even">
<td style="text-align: center;">Poisson</td>
<td style="text-align: center;">Gamma</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Normal (mean)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Inverse Gamma (variance)</td>
</tr>
</tbody>
</table>
</section>
<section id="point-estimators" class="slide level2">
<h2>Point Estimators</h2>
<ul>
<li class="fragment"><p><span class="math inline">\((\Theta \mid X = x)\)</span> is a random variable. How to get a point estimator of <span class="math inline">\(\Theta\)</span>?</p></li>
<li class="fragment"><p>Answer: many different possiblities, corresponding to different summary statistics.</p>
<ul>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Posterior Mean</strong></span>: <span class="math inline">\(\widehat{\theta}_{\mathrm{post}} := \E[\Theta \mid X]\)</span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Posterior Median</strong></span>: <span class="math inline">\(\widehat{\theta}_{\mathrm{post med.}} := \mathrm{median}\{\Theta \mid X\}\)</span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Maximum <em>a posteriori</em> &nbsp;Estimator</strong></span> (MAP): <span class="math inline">\(\widehat{\theta}_{\mathrm{MAP}} := \argmax\limits_{\theta}\{p(\theta \mid X)\}\)</span> (posterior mode)</p></li>
</ul></li>
</ul>
</section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence Intervals</h2>
<ul>
<li class="fragment"><p>Frequentist CI: <span class="math inline">\([l(Y) \ , \ u(Y)]\)</span> such that <span class="math display">\[ \Prob_{\theta}(l(Y) \leq Y \leq u(Y)) = 1 - \alpha \]</span></p>
<ul>
<li class="fragment">Key point: <em>endpoints</em> are random.</li>
</ul></li>
<li class="fragment"><p>Expect this interval to cover the “true” value of <span class="math inline">\(\theta\)</span> 95% of the time</p>
<ul>
<li class="fragment"><em>Before</em> data is observed</li>
</ul></li>
</ul>
</section>
<section id="confidence-intervals-1" class="slide level2">
<h2>Confidence Intervals</h2>

<img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="credible-intervals" class="slide level2">
<h2>Credible Intervals</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition: Posterior Credible Intervals</strong></p>
</div>
<div class="callout-content">
<p>A <span class="math inline">\((1 - \alpha) \times 100\%\)</span> <span style="color:#fa8b2f"><strong>posterior credible interval</strong></span> is an interval <span class="math inline">\([l(y) \ , \ u(y)]\)</span> such that <span class="math display">\[ \Prob(\theta \in [l(y) \ , \ u(y)] \mid Y = y) = 1 - \alpha \]</span></p>
</div>
</div>
</div>
<ul>
<li class="fragment">Crucially, posterior credible intervals are <em>not</em> unique.</li>
</ul>
</section>
<section id="hpd-intervals" class="slide level2">
<h2>HPD Intervals</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition: Highest Posterior Density Interval</strong></p>
</div>
<div class="callout-content">
<p>A <span class="math inline">\((1 - \alpha) \times 100\%\)</span> <span style="color:#fa8b2f"><strong>HPD interval</strong></span> (Highest Posterior Density interval) is an interval <span class="math inline">\(A \subseteq \R\)</span> such that:</p>
<div>
<ol type="1">
<li><p><span class="math inline">\(\Prob(\theta \in A \mid Y = y) = 1 - \alpha\)</span> (i.e.&nbsp;<span class="math inline">\(A\)</span> is a <span class="math inline">\((1 - \alpha) \times 100\%\)</span> credible interval)</p></li>
<li><p><span class="math inline">\(p(\theta_a \mid y) &gt; p(\theta_b \mid y)\)</span> for any <span class="math inline">\(\theta_a \in A\)</span> and <span class="math inline">\(\theta_b \notin A\)</span> (i.e.&nbsp;the posterior density over <span class="math inline">\(A\)</span> is higher than over any other region).</p></li>
</ol>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">One can show that an HPD region is the <em>smallest</em> region with probability <span class="math inline">\((1 - \alpha)\)</span></li>
</ul>
</section>
<section id="hpd-intervals-1" class="slide level2">
<h2>HPD Intervals</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Theorem</strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(f(x)\)</span> be a unimodal density function, and let <span class="math inline">\(I := [a, b]\)</span> (with <span class="math inline">\(-\infty &lt; a &lt; b &lt; \infty\)</span>) be an interval satisfying <span class="math inline">\(\int_{a}^{b} f(x) \ \mathrm{d}x = 1 - \alpha\)</span>. If:</p>
<div>
<ol type="1">
<li><span class="math inline">\(f(a) = f(b) \neq 0\)</span>, and</li>
<li><span class="math inline">\(I\)</span> contains the mode of <span class="math inline">\(f(x)\)</span>,</li>
</ol>
</div>
<p>then <span class="math inline">\(I\)</span> is the shortest interval such that <span class="math inline">\(\int_{a}^{b} f(x) \ \mathrm{d}x = 1 - \alpha\)</span></p>
</div>
</div>
</div>
<ul>
<li class="fragment">Moral: for unimodal posteriors, can construct an HPD by examining intervals containing the mode.</li>
</ul>
</section>
<section id="credible-interval" class="slide level2">
<h2>70% Credible Interval</h2>

<img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="credible-interval-1" class="slide level2">
<h2>70% Credible Interval</h2>

<img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="hpd-interval" class="slide level2">
<h2>70% HPD Interval</h2>
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">library</span>(HDInterval)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">hdi</span>(qbeta, </span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="at">credMass =</span> <span class="fl">0.7</span>, </span>
<span id="cb15-5"><a href="#cb15-5"></a>    <span class="at">shape1 =</span> <span class="dv">2</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>    <span class="at">shape2 =</span> <span class="dv">4</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lower      upper 
0.09405597 0.47015311 
attr(,"credMass")
[1] 0.7</code></pre>
</div>
</div>
</div>
</section>
<section id="hpd-interval-1" class="slide level2">
<h2>70% HPD Interval</h2>

<img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="two-parameter-models" class="slide level2">
<h2>Two-Parameter Models</h2>
<ul>
<li class="fragment"><p>E.g. <span class="math inline">\((Y \mid \mu , \sigma^2) \sim \mathcal{N}(\mu, \sigma^2)\)</span>.</p></li>
<li class="fragment"><p>Can show <span class="math inline">\(\mu \sim \mathcal{N}(\cdot, \cdot)\)</span> is conjugate prior for <span class="math inline">\(\mu\)</span>, assuming <span class="math inline">\(\sigma^2\)</span> is known.</p></li>
<li class="fragment"><p>Can show <span class="math inline">\(\sigma^2 \sim \mathrm{InvGamm}(\cdot, \cdot)\)</span> is conjugate prior for <span class="math inline">\(\sigma^2\)</span>, assuming <span class="math inline">\(\mu = 0\)</span>.</p></li>
<li class="fragment"><p>Instead, could specify a <em>joint</em> prior <span class="math inline">\(\pi(\mu, \sigma^2)\)</span>.</p></li>
<li class="fragment"><p>Computations analogous to one-parameter case.</p></li>
</ul>
</section></section>
<section>
<section id="choosing-a-prior" class="title-slide slide level1 center">
<h1>Choosing a Prior</h1>

</section>
<section id="choice-of-prior" class="slide level2">
<h2>Choice of Prior</h2>
<ul>
<li class="fragment"><p>How to pick an appropriate prior?</p></li>
<li class="fragment"><p>Several different schools of thought.</p></li>
<li class="fragment"><p>First idea: conjugacy.</p>
<ul>
<li class="fragment"><p>Pros: easy, and computationally tractable</p></li>
<li class="fragment"><p>Cons: potentially too restrictive</p></li>
</ul></li>
<li class="fragment"><p>Second idea: <span style="color:#fa8b2f"><strong>noninformative priors</strong></span>. Loosely speaking: set prior <span class="math inline">\(\pi(\theta) \propto \mathrm{const}\)</span> on the appropriate support.</p>
<ul>
<li class="fragment"><p>Pros: allows for more flexibility</p></li>
<li class="fragment"><p>Cons: doesn’t always lead to a propr posterior; also, might be better to inject information by way of <span style="color:#fa8b2f"><strong>domain knowledge</strong></span>.</p></li>
</ul></li>
</ul>
</section>
<section id="example-of-an-uninformative-prior" class="slide level2">
<h2>Example of an Uninformative Prior</h2>
<ul>
<li class="fragment"><p><span class="math inline">\(X \sim \mathcal{N}(0, \sigma^2)\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(\pi(\sigma^2) \propto 1/(\sigma^2)\)</span> on <span class="math inline">\((0, \infty)\)</span>.</p>
<ul>
<li class="fragment">Not a proper density; integrates to <span class="math inline">\(\infty!\)</span></li>
</ul></li>
<li class="fragment"><p><span class="math inline">\(\begin{aligned}[t] p(\sigma^2 \mid X = x) &amp; \propto p(X \mid \sigma^2) \cdot \pi(\sigma^2) \\ &amp; \propto \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\left\{ - \frac{1}{2 \sigma^2} x^2 \right\} \cdot \frac{1}{\sigma^2} \\ &amp; \propto \frac{1}{(\sigma^2)^{3/2}} \cdot \exp\left\{ - \frac{x^2}{2(\sigma^2)} \right\} \\ &amp; \sim \mathrm{InvGamma}(4, x) \end{aligned}\)</span></p></li>
</ul>
</section></section>
<section>
<section id="sampling-from-the-posterior" class="title-slide slide level1 center">
<h1>Sampling from the Posterior</h1>

</section>
<section id="leadup-2" class="slide level2">
<h2>Leadup</h2>
<ul>
<li class="fragment"><p>At the start of this lesson, we saw the importance and power of Monte Carlo simulation.</p></li>
<li class="fragment"><p>Key idea: if we can draw from a posterior, we can avoid a lot of pesky math.</p></li>
<li class="fragment"><p>Sampling from posterior: easy enough for “famous” distributions (e.g.&nbsp;normal, beta, uniform, etc.)</p></li>
<li class="fragment"><p>But, for more complicated posteriors (which arise frequently in real-life), isn’t always so simple!</p></li>
</ul>
</section>
<section id="sampling-from-the-posterior-1" class="slide level2">
<h2>Sampling from the Posterior</h2>
<ul>
<li class="fragment"><p>Goal: generate sample <span class="math inline">\(\theta^{(s)} \sim p(\theta \mid x_1, \cdots, x_n)\)</span>.</p></li>
<li class="fragment"><p>Several techniques available:</p>
<ul>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Grid Approximation</strong></span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Inversion Sampling</strong></span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Rejection Sampling</strong></span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Importance Sampling</strong></span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Markov Chain Monte Carlo</strong></span></p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Variational Bayes</strong></span></p></li>
</ul></li>
<li class="fragment"><p><strong><em>Still an open area of research!</em></strong></p>
<ul>
<li class="fragment"><a href="https://link.springer.com/article/10.1007/s11222-015-9574-5">28 pages</a>, back in 2015</li>
</ul></li>
</ul>
</section>
<section id="inversion-sampling" class="slide level2">
<h2>Inversion Sampling</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Theorem: Probability Integral Transform</strong></p>
</div>
<div class="callout-content">
<p>Given a random variable <span class="math inline">\(X \sim F_X\)</span>, we have that <span class="math inline">\(U := F_X(X) \sim \mathrm{Unif}[0, 1]\)</span></p>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>Proof: found in PSTAT 120B (relatively simple using CDF method.)</p></li>
<li class="fragment"><p>Leads to following sampling scheme (often called <span style="color:#fa8b2f"><strong>Inversion Sampling</strong></span>):</p>
<ol type="1">
<li class="fragment"><p>Generate <span class="math inline">\(U_1, \cdots, U_n \iid \mathrm{Unif}[0, 1]\)</span></p></li>
<li class="fragment"><p>Apply quantile function of posterior to <span class="math inline">\(U_1, \cdots, U_n\)</span> to generate a sample <span class="math inline">\(\theta_1, \cdots, \theta_n\)</span> which will follow the posterior distribution.</p></li>
</ol></li>
</ul>
</section>
<section id="inversion-sampling-example" class="slide level2">
<h2>Inversion Sampling: Example</h2>
<ul>
<li class="fragment"><p>Example: use inversion sampling to generate a sample from the <span class="math inline">\(\mathrm{Exp}(\beta)\)</span> distribution.</p></li>
<li class="fragment"><p>CDF of <span class="math inline">\(\mathrm{Exp}(\beta)\)</span> distribution is <span class="math inline">\(F_X(x) = 1 - e^{-x / \beta}\)</span>, so quantile function is <span class="math display">\[ F_X^{-1}(u) = - \beta \ln(1 - u) \]</span></p></li>
</ul>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>quant_func <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(u, beta) {</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">return</span>(<span class="sc">-</span>beta <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u))</span>
<span id="cb17-3"><a href="#cb17-3"></a>})</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb17-8"><a href="#cb17-8"></a>X <span class="ot">&lt;-</span> <span class="fu">quant_func</span>(U, <span class="at">beta =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="inversion-sampling-example-1" class="slide level2">
<h2>Inversion Sampling: Example</h2>

<img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section id="grid-approximation" class="slide level2" style="font-size:32px">
<h2>Grid Approximation</h2>
<ul>
<li class="fragment"><p><strong>Goal:</strong> produce an <em>independent</em> sample of size <span class="math inline">\(N\)</span> <span class="math inline">\(\{\theta^{(1)} , \cdots, \theta^{(N)}\}\)</span> from a discretized approximation of posterior <span class="math inline">\(p(\theta \mid x)\)</span></p></li>
<li class="fragment"><p>Four main steps:</p>
<ol type="1">
<li class="fragment"><p>Specify discrete grid of possible <span class="math inline">\(\theta\)</span> values</p></li>
<li class="fragment"><p>Evaluate prior <span class="math inline">\(\pi(\theta)\)</span> and likelihood <span class="math inline">\(p(y \mid \theta)\)</span> at each point in grid</p></li>
<li class="fragment"><p>Multiply <span class="math inline">\(\pi(\theta)\)</span> and <span class="math inline">\(p(y \mid \theta)\)</span> at each point <span class="math inline">\(\theta\)</span> in the grid of possible values, then divide by the sum of the products (i.e.&nbsp;<em>normalize</em>)</p></li>
<li class="fragment"><p>Take a discrete unfiorm sample from the possible <span class="math inline">\(\theta\)</span> values, <em>with replacement</em>, with weights proportional to the values you computed in step (3)</p></li>
</ol></li>
</ul>
</section>
<section id="example-due-to-johnson-ott-and-doğucu" class="slide level2">
<h2>Example (due to Johnson, Ott, and Doğucu)</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Setup</strong></strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\begin{align*}
  (X \mid \theta)    &amp; \sim \mathrm{Bin}(10, \pi)    \\
  \theta             &amp; \sim \mathrm{Beta}(2, 2)
\end{align*}\]</span> Observe <span class="math inline">\(Y = 9\)</span> (e.g.&nbsp;toss coin 10 times, and observe 9 heads). Goal: sample from posterior <span class="math inline">\(p(\theta \mid 9)\)</span>.</p>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Step 1:</strong></p>
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>N <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>theta_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<div class="fragment">
<p><strong>Step 2:</strong></p>
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>discretized_prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta_grid, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>discretized_likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">9</span>, <span class="dv">10</span>, theta_grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><br>
</p>
<div class="fragment">
<p><strong>Step 3:</strong></p>
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>unnormalized_post <span class="ot">&lt;-</span> discretized_prior <span class="sc">*</span>  discretized_likelihood</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a>post <span class="ot">&lt;-</span> unnormalized_post <span class="sc">/</span> <span class="fu">sum</span>(unnormalized_post)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="fu">round</span>(post, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00 0.00 0.01 0.18 0.81 0.00</code></pre>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<div class="fragment">
<p><strong>Step 4:</strong></p>
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>post_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(theta_grid, </span>
<span id="cb22-3"><a href="#cb22-3"></a>                      <span class="at">size =</span> <span class="dv">10000</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>                      <span class="at">prob =</span> post,</span>
<span id="cb22-5"><a href="#cb22-5"></a>                      <span class="at">replace =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-22-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section class="slide level2">

<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Step 1</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>theta_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> N)</span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co"># Step 2</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>discretized_prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta_grid, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7"></a>discretized_likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">9</span>, <span class="dv">10</span>, theta_grid)</span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co"># Step 3</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>unnormalized_post <span class="ot">&lt;-</span> discretized_prior <span class="sc">*</span> discretized_likelihood</span>
<span id="cb23-11"><a href="#cb23-11"></a></span>
<span id="cb23-12"><a href="#cb23-12"></a>post <span class="ot">&lt;-</span> unnormalized_post <span class="sc">/</span> <span class="fu">sum</span>(unnormalized_post)</span>
<span id="cb23-13"><a href="#cb23-13"></a></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co"># Step 4</span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-16"><a href="#cb23-16"></a>post_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(theta_grid, </span>
<span id="cb23-17"><a href="#cb23-17"></a>                      <span class="at">size =</span> <span class="dv">10000</span>,</span>
<span id="cb23-18"><a href="#cb23-18"></a>                      <span class="at">prob =</span> post,</span>
<span id="cb23-19"><a href="#cb23-19"></a>                      <span class="at">replace =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-24-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="pros-and-cons" class="slide level2">
<h2>Pros and Cons</h2>
<ul>
<li class="fragment"><p>Not too difficult to code!</p>
<ul>
<li class="fragment">Results are also pretty good, most of the time</li>
</ul></li>
<li class="fragment"><p><strong>But</strong>, can get computationally infeasible pretty quickly.</p></li>
<li class="fragment"><p>Especially true for models with not just one but <em>many</em> parameters</p></li>
</ul>
</section>
<section id="markov-chain-monte-carlo" class="slide level2">
<h2>Markov Chain Monte Carlo</h2>
<ul>
<li class="fragment"><p>One popular technique: <span style="color:#fa8b2f"><strong>Markov Chain Monte Carlo</strong></span></p></li>
<li class="fragment"><p>General idea: forgo i.i.d.-ness of sample, opting instead for correlated samples that <em>converge</em> to the true posterior.</p></li>
<li class="fragment"><p>Specifically, produces a <span style="color:#fa8b2f"><strong>Markov Chain</strong></span> <span class="math inline">\(\{\theta^{(1)} , \cdots, \theta^{(N)}\}\)</span> whose limiting distribution is the posterior.</p></li>
<li class="fragment"><p><span style="color:#fa8b2f"><strong>Markov Property</strong></span>: <span class="math inline">\(\displaystyle p\left( \theta^{(i + 1)} \mid \theta^{(1)} , \cdots, \theta^{(i)} \right) = p\left( \theta^{(i + 1)} \mid \theta^{(i)}, y \right)\)</span></p></li>
<li class="fragment"><p>Key point: none of the <span class="math inline">\(\theta^{(i)}\)</span>’s are sampled directly from the posterior</p></li>
</ul>
</section>
<section id="mcmc" class="slide level2">
<h2>MCMC</h2>
<ul>
<li class="fragment"><p>I’ll skip much of the details (as they involve material from PSTAT 160A).</p></li>
<li class="fragment"><p>Instead, we’ll use <code>rstan</code>, an <code>R</code> package that allows us to use the programming language <code>Stan</code> (see <a href="https://mc-stan.org/">this</a> link for more details on Stan)</p></li>
<li class="fragment"><p>Two main steps:</p>
<ol type="1">
<li class="fragment">Define the Bayesian model structure</li>
<li class="fragment">Simulate the posterior</li>
</ol></li>
</ul>
</section>
<section id="step-1-define-model-structure" class="slide level2">
<h2>Step 1: Define Model Structure</h2>
<ul>
<li class="fragment"><p>Three aspects:</p>
<ul>
<li class="fragment"><p><code>data</code>: what is the type of data that gets observed (integers? real numbers? vectors?)</p></li>
<li class="fragment"><p><code>parameters</code>: what are the parameters? What are their types (integers? real numbers? vectors?)</p></li>
<li class="fragment"><p><code>model</code>: what are the prior and likelihood?</p></li>
</ul></li>
<li class="fragment"><p>Let’s re-do our Beta-Binomial example, this time in <code>rstan</code>.</p></li>
</ul>
</section>
<section id="step-1-define-model-structure-1" class="slide level2">
<h2>Step 1: Define Model Structure</h2>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>beta_binom_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="st">  data {</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="st">    int&lt;lower = 0, upper = 10&gt; Y;</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="st">  }</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="st">  parameters {</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="st">    real&lt;lower = 0, upper = 1&gt; theta;</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="st">  }</span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="st">  model {</span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="st">    Y ~ binomial(10, theta);</span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="st">    theta ~ beta(2, 2);</span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="st">  }</span></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-simulate-posterior" class="slide level2">
<h2>Step 2: Simulate Posterior</h2>
<ul>
<li class="fragment"><p>Next, we simulate the posterior using the function <code>stan()</code>. (This might be quite slow for certain problems!)</p></li>
<li class="fragment"><p>Two main types of arguments:</p>
<ul>
<li class="fragment"><p><strong>Model Information</strong>:</p>
<ul>
<li class="fragment"><code>model_code</code> = our model specification (from Step 1)</li>
<li class="fragment"><code>data</code> = the observed data (in this case, `Y = 9)</li>
</ul></li>
<li class="fragment"><p><strong>Markov Chain Information</strong>:</p>
<ul>
<li class="fragment"><code>chains</code>: how many parallel Markov chains should be run?</li>
<li class="fragment"><code>iter</code>: how many iterations in each chain (i.e.&nbsp;length of each chain)</li>
<li class="fragment"><code>seed</code>: setting the seed</li>
</ul></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a>beta_binom_sim <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="at">model_code =</span> beta_binom_model,</span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="at">data =</span> <span class="fu">list</span>(<span class="at">Y =</span> <span class="dv">9</span>),</span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="at">iter =</span> <span class="dv">5000</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="at">seed =</span> <span class="dv">123</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 4e-06 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 1: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 1: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 1: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 1: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 1: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 1: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 1: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 1: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 1: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 1: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 1: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.014 seconds (Warm-up)
Chain 1:                0.014 seconds (Sampling)
Chain 1:                0.028 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 0 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 2: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 2: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 2: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 2: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 2: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 2: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 2: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 2: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 2: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 2: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 2: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.014 seconds (Warm-up)
Chain 2:                0.014 seconds (Sampling)
Chain 2:                0.028 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 0 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 3: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 3: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 3: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 3: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 3: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 3: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 3: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 3: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 3: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 3: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 3: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.014 seconds (Warm-up)
Chain 3:                0.016 seconds (Sampling)
Chain 3:                0.03 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 0 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 4: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 4: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 4: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 4: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 4: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 4: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 4: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 4: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 4: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 4: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 4: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.014 seconds (Warm-up)
Chain 4:                0.014 seconds (Sampling)
Chain 4:                0.028 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">class</span>(beta_binom_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "stanfit"
attr(,"package")
[1] "rstan"</code></pre>
</div>
</div>
</div>
</div>
<p><br>
</p>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">as.array</span>(beta_binom_sim, <span class="at">pars =</span> <span class="st">"theta"</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , parameters = theta

          chains
iterations   chain:1   chain:2   chain:3   chain:4
      [1,] 0.8651027 0.8185750 0.8138553 0.8279933
      [2,] 0.9111394 0.8066341 0.8131823 0.8273745
      [3,] 0.8931825 0.6175881 0.7898339 0.8126268
      [4,] 0.9055053 0.6484576 0.8017672 0.8399888
      [5,] 0.9249503 0.6106970 0.5982884 0.8059586
      [6,] 0.8391062 0.4436234 0.7002322 0.8029121</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="traceplot" class="slide level2">
<h2>Traceplot</h2>
<div class="fragment">
<div class="big-code">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-29-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-histogram" class="slide level2">
<h2>Posterior Histogram</h2>

<img data-src="Bayes2_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section id="burn-in" class="slide level2">
<h2>Burn-In</h2>
<ul>
<li class="fragment"><p>In the context of MCMC, you’ll often hear the word <span style="color:#fa8b2f"><strong>burnin</strong></span> used.</p></li>
<li class="fragment"><p>This refers to the practice of throwing out the first portion of the Markov chain values.</p></li>
<li class="fragment"><p>The rationale is as follows: our Markov chains only <em>converge</em> to the true posterior. In many cases, the chain doesn’t quite get to the right posterior until much later in the simulation. Hence, while the chain is still learning the behavior of the posterior, it makes sense to throw out the initial values.</p></li>
</ul>
</section>
<section id="diagnostics" class="slide level2">
<h2>Diagnostics</h2>
<ul>
<li class="fragment"><p>A crucial part of statistics is not only model-building, but also <em>diagnostics</em>.</p></li>
<li class="fragment"><p>A “good” Markov chain has traceplots that resemble white noise, with no noticeable trend or phenomena.</p></li>
<li class="fragment"><p>On the other hand, “bad” Markov chains may display trend (which is indicative of a chain that hasn’t mixed well), or might get stuck at certain values of the parameter space.</p></li>
</ul>
</section>
<section id="example-due-to-johnson-ott-and-doğucu-1" class="slide level2">
<h2>Example (due to Johnson, Ott, and Doğucu)</h2>

<img data-src="bad-trace-1.png" class="r-stretch"></section>
<section id="possible-fixes" class="slide level2">
<h2>Possible Fixes</h2>
<ol type="1">
<li class="fragment"><p>Check the model, and reassess its fit</p></li>
<li class="fragment"><p>Run the chain for more iterations</p></li>
</ol>
<p><br>
</p>
<ul>
<li class="fragment">Another diagnostic tool: check whether the multiple chains have mixed well. (Remember that we generated 4!)</li>
</ul>
</section></section>
<section>
<section id="selfish-diversion" class="title-slide slide level1 center">
<h1>Selfish Diversion</h1>

</section>
<section id="final-thoughts" class="slide level2">
<h2>Final Thoughts</h2>
<ul>
<li class="fragment"><p>Consider a statistical modeling problem: <span class="math display">\[ y_i = f(x_i) + \varepsilon_i \]</span> with <span class="math inline">\(\varepsilon_i \stackrel{\mathrm{i.i.d.}}{\sim} \mathcal{N}(0, \sigma^2)\)</span></p></li>
<li class="fragment"><p>Much literature devoted to estimation of <span class="math inline">\(f(\cdot)\)</span>.</p></li>
<li class="fragment"><p>Idea: borrow from Bayesian framework and <em>assign a prior to</em> <span class="math inline">\(f(\cdot)\)</span>!</p></li>
<li class="fragment"><p>Lot’s of choices of (albeit weird) priors: <span style="color:#fa8b2f"><strong>Dirichlet Processes</strong></span> and <span style="color:#fa8b2f"><strong>Gaussian Processes</strong></span>.</p></li>
<li class="fragment"><p>I’m actually working with the latter in my ongoing research, but maybe that’s a tale for another time…</p></li>
</ul>
</section></section>
<section>
<section id="selected-proofs" class="title-slide slide level1 center">
<h1>Selected Proofs</h1>

</section>
<section id="theorem-1" class="slide level2" style="font-size:28px">
<h2>Theorem 1</h2>
<blockquote>
<p>Let <span class="math inline">\(A\)</span> be an event with probability of occurrence <span class="math inline">\(\Prob(A)\)</span>. Let <span class="math inline">\(Y_n\)</span> be defined as the proportion of times the event <span class="math inline">\(A\)</span> occurs in <span class="math inline">\(n\)</span> repetitions of the underlying experiment: then <span class="math inline">\(Y_n\)</span> converges to <span class="math inline">\(\Prob(A)\)</span> in probability: <span class="math display">\[ Y_n \stackrel{p}{\longrightarrow} \Prob(A) \]</span></p>
</blockquote>
<ul>
<li class="fragment"><p>Let <span class="math inline">\(X_i = \1_{\{\text{$A$ occurs on $i$th trial}\}} \sim \mathrm{Bern}(\Prob(A))\)</span></p></li>
<li class="fragment"><p>Then, <span class="math inline">\(Y_n = n^{-1} \sum_{i=1}^{n} X_i =: \overline{X}_n\)</span>.</p></li>
<li class="fragment"><p>By the Weak Law of Large Numbers (which we can invoke since <span class="math inline">\(\E[X_i] = \Prob(A) &lt; \infty\)</span> and <span class="math inline">\(\Var(X_i) = \Prob(A) \Prob(A^{\complement}) &lt; \infty\)</span>), we have that <span class="math display">\[ Y_n = \overline{X}_n \stackrel{p}{\longrightarrow} \E[X_i] = \Prob(A) \]</span></p></li>
</ul>
</section>
<section id="probability-integral-transform" class="slide level2" style="font-size:28px">
<h2>Probability Integral Transform</h2>
<blockquote>
<p>Given a continuous random variable <span class="math inline">\(X \sim F_X\)</span>, we have that <span class="math inline">\(U := F_X(X) \sim \mathrm{Unif}[0, 1]\)</span></p>
</blockquote>
<ul>
<li class="fragment"><p>First note: <span class="math inline">\(F_X(\cdot)\)</span> is monotone increasing, and hence invertible.</p>
<ul>
<li class="fragment">Inverse (quantile function) is also monotone increasing.</li>
</ul></li>
<li class="fragment"><p>By CDF Method, <span class="math display">\[\begin{align*}
  F_U(u)    &amp; := \Prob(U \leq u)    \\
        &amp; = \Prob(F_X(X) \leq u) = \Prob(X \leq F_X^{-1}(u))    \\
        &amp; = F_X[F_X^{-1}(u)] = u
\end{align*}\]</span> which is the CDF of the <span class="math inline">\(\mathrm{Unif}[0, 1]\)</span> distribution.</p>
<ul>
<li class="fragment">Direction of inequality does not change, due to monotone increasing nature of <span class="math inline">\(F_X^{-1}(\cdot)\)</span>.</li>
</ul></li>
</ul>

<img src="pstat_logo.svg" class="slide-logo r-stretch"><div class="footer footer-default">
<p>UCSB: Department of Statistics and Applied Probability</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Bayes2_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Bayes2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Bayes2_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Bayes2_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"17093219234761479600","id":"9f04a798943c87d6","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="ojs-module-contents">
    {"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"viewof alpha_2 = Inputs.range(\n  [0.1, 5], \n  {value: 1.5, step: 0.1, label: \"alpha = \"}\n)\n\nviewof beta_2 = Inputs.range(\n  [0.1, 5], \n  {value: 0.5, step: 0.1, label: \"beta = \"}\n)\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"\nmargin = ({top: 20, right: 30, bottom: 30, left: 40})\n\nheight = 400\n\nx_values_2 = d3.scaleLinear()\n    .domain(d3.extent(data_2, d => d.x))\n    .range([margin.left, width - margin.right])\n\ny_values_2 = d3.scaleLinear()\n    .domain([Math.min(d3.min(data_2, d => d.y),0), Math.max(1,d3.max(data_2, d => d.y))]).nice()\n    .range([height - margin.bottom, margin.top])\n    \nline_2 = d3.line()\n    .x(d => x_values_2(d.x))\n    .y(d => y_values_2(d.y))\n\nxAxis_2 = g => g\n  .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n  .call(d3.axisBottom(x_values_2)\n      .ticks(width / 80)\n      .tickSizeOuter(0))\n\nyAxis_2 = g => g\n  .attr(\"transform\", `translate(${margin.left},0)`)\n  .call(d3.axisLeft(y_values_2)\n      .tickValues(d3.scaleLinear().domain(y_values_2.domain()).ticks()))\n\nmathfn = require('https://bundle.run/mathfn@1.1.0')\n\nabs_x=6\n\nfunction gamma_pdf (input_value, alpha, beta) {\n  if(input_value < 0) {\n    return 0\n  } else {\n    let left_const = 1/(mathfn.gamma(beta_2) * beta_2**alpha_2)\n    let mid_var = input_value**(alpha_2 - 1)\n    let right_var = Math.exp(-input_value/beta_2)\n    return left_const * mid_var * right_var\n  }\n}\n\ndata_2 = {\n  let values = [];\n  for (let x = -0.5; x < abs_x; x=x+0.01) values.push({\"x\":x,\"y\":gamma_pdf(x, alpha_2, beta_2)});\n  return values;\n}\n\nd3 = require(\"https://d3js.org/d3.v5.min.js\")\n\nchart_2 = {\n  const svg = d3.select(DOM.svg(width, height));\n\n  svg.append(\"g\")\n      .call(xAxis_2);\n\n  svg.append(\"g\")\n      .call(yAxis_2);\n  \n  svg.append(\"path\")\n      .datum(data_2)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", \"#fa8b2f\")\n      .attr(\"stroke-width\", 5)\n      .attr(\"stroke-linejoin\", \"round\")\n      .attr(\"stroke-linecap\", \"round\")\n      .attr(\"d\", line_2);\n  \n  return svg.node();\n}\n\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"viewof alpha_3 = Inputs.range(\n  [0, 5], \n  {value: 2, step: 0.1, label: \"alpha = \"}\n)\n\nviewof beta_3 = Inputs.range(\n  [0, 5], \n  {value: 3, step: 0.1, label: \"beta = \"}\n)\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"\nwidth = 1000\n\nx_values_5 = d3.scaleLinear()\n    .domain(d3.extent(data_5, d => d.x))\n    .range([margin.left, width - margin.right])\n\ny_values_5 = d3.scaleLinear()\n    .domain([Math.min(d3.min(data_5, d => d.y),0), Math.max(1,d3.max(data_5, d => d.y))]).nice()\n    .range([height - margin.bottom, margin.top])\n    \nline_5 = d3.line()\n    .x(d => x_values_5(d.x))\n    .y(d => y_values_5(d.y))\n\nxAxis_5 = g => g\n  .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n  .call(d3.axisBottom(x_values_5)\n      .ticks(width / 80)\n      .tickSizeOuter(0))\n\nyAxis_5 = g => g\n  .attr(\"transform\", `translate(${margin.left},0)`)\n  .call(d3.axisLeft(y_values_5)\n      .tickValues(d3.scaleLinear().domain(y_values_5.domain()).ticks()))\n\nfunction beta_pdf (input_value, alpha, beta) {\n  if(input_value < 0) {\n    return 0\n  } else if(input_value > 1) {\n    return 0\n  } else {\n    let const1 = mathfn.beta(alpha, beta)\n    let var1 = input_value**(alpha - 1)\n    let var2 = (1 - input_value)**(beta - 1)\n    return (1/const1) * var1 * var2\n  }\n}\n\ndata_5 = {\n  let values = [];\n  for (let x = 0; x < 1; x=x+0.01) values.push({\"x\":x,\"y\":beta_pdf(x, alpha_3, beta_3)});\n  return values;\n}\n\nchart_5 = {\n  const svg = d3.select(DOM.svg(width, height));\n\n  svg.append(\"g\")\n      .call(xAxis_5);\n\n  svg.append(\"g\")\n      .call(yAxis_5);\n  \n  svg.append(\"path\")\n      .datum(data_5)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", \"#fa8b2f\")\n      .attr(\"stroke-width\", 4)\n      .attr(\"stroke-linejoin\", \"round\")\n      .attr(\"stroke-linecap\", \"round\")\n      .attr(\"d\", line_5);\n  \n  return svg.node();\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('alpha_2')"},{"methodName":"interpretQuiet","source":"shinyInput('beta_2')"},{"methodName":"interpretQuiet","source":"shinyInput('alpha_3')"},{"methodName":"interpretQuiet","source":"shinyInput('beta_3')"}]}
    </script>
    <script type="module">
    if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
    window._ojs.paths.runtimeToDoc = "../../..";
    window._ojs.paths.runtimeToRoot = "../../..";
    window._ojs.paths.docToRoot = "";
    window._ojs.selfContained = false;
    window._ojs.runtime.interpretFromScriptTags();
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>