<!DOCTYPE html>
<html lang="en"><head>
<script src="finrev_files/libs/clipboard/clipboard.min.js"></script>
<script src="finrev_files/libs/quarto-html/tabby.min.js"></script>
<script src="finrev_files/libs/quarto-html/popper.min.js"></script>
<script src="finrev_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="finrev_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="finrev_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="finrev_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="finrev_files/libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="finrev_files/libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <meta name="author" content="Ethan P. Marzban">
  <title>Final Review</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="finrev_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="finrev_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="finrev_files/libs/revealjs/dist/theme/quarto-23665cddef3566fd5ae8f4d9eb93eac1.css">
  <link href="finrev_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="finrev_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="finrev_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="finrev_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="finrev_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="finrev_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {enableAssistiveMml: false}});</script>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="Images/logo.png" data-background-opacity="0.5" data-background-position="80% 50%" data-background-size="35%" class="quarto-title-block center">
  <h1 class="title">Final Review</h1>
  <p class="subtitle">PSTAT 120B, Spring 2025, with Dr.&nbsp;Brian Wainwright</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Ethan P. Marzban 
</div>
        <p class="quarto-title-affiliation">
            Department of Statistics and Applied Probability; UCSB <br> <br>
          </p>
        <p class="quarto-title-affiliation">
            May 6, 2025
          </p>
    </div>
</div>

</section>
<section class="slide level2">

<div class="hidden">
<p><span class="math display">\[
\newcommand\R{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\1}{1\!\!1}
\newcommand{\comp}[1]{#1^{\complement}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\SD}{\mathrm{SD}}
\newcommand{\vect}[1]{\vec{\boldsymbol{#1}}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Corr}{\mathrm{Corr}}
\usepackage[makeroom]{cancel}
\newcommand{\iid}{\stackrel{\mathrm{i.i.d.}}{\sim}}
\newcommand{\probto}{\stackrel{\mathrm{p}}{\longrightarrow}}
\newcommand{\distto}{\stackrel{\mathrm{d}}{\longrightarrow}}
\newcommand{\Lik}{\mathcal{L}}
\DeclareMathOperator*{\argmax}{\mathrm{arg} \ \max}
\]</span></p>
</div>
<div class="cell">
<style type="text/css">
.hscroll {
  height: 100%;
  max-height: 600px;
  max-width: 2000px;
  overflow: scroll;
}

.hscroll2 {
  height: 100%;
  max-height: 300px;
  overflow: scroll;
}

.hscroll3 {
  max-width: 2rem;
  overflow: scroll;
}
</style>
</div>
</section>
<section id="roadmap-for-today" class="slide level2">
<h2><i class="fa-solid fa-map" aria-label="map"></i> Roadmap for Today</h2>
<ul>
<li class="fragment"><p>Go through some slides (including some interactive problems)</p></li>
<li class="fragment"><p>Work through some problems together (on the worksheet; copies can be found at the front of the room)</p></li>
</ul>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Disclaimer</strong></strong></p>
</div>
<div class="callout-content">
<p>I have not seen the exam yet, so I do not know exactly what will or will not be on it. Just because something does or does not show up on these slides doesn’t mean it is guaranteed to show up / not show up on the exam.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Disclaimer</strong></strong></p>
</div>
<div class="callout-content">
<p>This review is not intended to be comprehensive; I encourage you to consult the lecture notes, textbook, homework, and your own notes.</p>
</div>
</div>
</div>
</div>
</section>
<section id="roadmap-for-today-1" class="slide level2">
<h2><i class="fa-solid fa-map" aria-label="map"></i> Roadmap for Today</h2>
<ul>
<li class="fragment"><p>Now, there is <em>far</em> too much material for me to be able to meaningfully cover everything that I think is important for the final.</p></li>
<li class="fragment"><p>Instead, I’ve elected to select a couple of topics which I think might be confusing (or topics I’d like to expound upon). I’ll go through these relatively quickly, though, as the best way to learn is to practice - so I’d like to leave plenty of time for us to work through some of the problems on the worksheet!</p></li>
<li class="fragment"><p>Order of coverage:</p>
<ol type="1">
<li class="fragment">Hypothesis Testing</li>
<li class="fragment">Estimation</li>
<li class="fragment">CI for a Difference in Means (time permitting)</li>
</ol></li>
</ul>
</section>
<section>
<section id="hypothesis-testing" class="title-slide slide level1 center" data-background-color="black" data-background-image="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExcThnd3ZxeWJtNmEzYmtwNnVlZGttb3ozZjU0YTJhaGF3ZmU3ZXVmeSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o6Mbbs879ozZ9Yic0/giphy.gif" data-background-size="70rem">
<h1>Hypothesis Testing</h1>

</section>
<section id="cats---again" class="slide level2">
<h2><i class="fa-solid fa-cat" aria-label="cat"></i> Cats - Again!</h2>
<h3 id="toe-beans">Toe Beans…</h3>
<ul>
<li class="fragment">According to a <a href="https://www.quora.com/What-percentage-of-cats-are-born-with-6-toes#:~:text=Your%20average%20domesticated%20cat%20has,the%20litter%20will%20be%20polys." target="_blank">Quora post</a>, the average cat has about a 10% chance of being born with <em>polydactyly</em></li>
</ul>
<div class="columns">
<div class="column" style="width:40%;">
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Images/polydactyl.png"></p>
<figcaption>Image Source: https://www.treehugger.com/thing-didnt-know-polydactyl-cats-4864197</figcaption>
</figure>
</div>
</div>
</div><div class="column" style="width:60%;">
<ul>
<li class="fragment"><p>Polydactyly refers to a condition whereby an animal is born with extra digits (e.g.&nbsp;extra fingers in humans, extra toes in cats, etc.)</p></li>
<li class="fragment"><p>Suppose we wish to assess the validity of the <em>Quora</em> claim, using data.</p>
<ul>
<li class="fragment">Note that we’re not necessarily trying to estimate the true incidence of polydactyly among cats!</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="cats---again-1" class="slide level2">
<h2><i class="fa-solid fa-cat" aria-label="cat"></i> Cats - Again!</h2>
<h3 id="toe-beans-1">Toe Beans…</h3>
<ul>
<li class="fragment"><p>Say we collect a simple random sample of 100 cats, and observe 9 polydactyl cats in this sample (i.e.&nbsp;<span class="math inline">\(\widehat{p}\)</span> = 9%).</p></li>
<li class="fragment"><p>Does this provide concrete evidence that the <em>Quora</em> claim is incorrect? Not really!</p></li>
<li class="fragment"><p>But, say our sample of 100 cats contains 80 polydactyl cats (<span class="math inline">\(\widehat{p}_{100}\)</span> = 80%). Or, say we saw only 1 polydactyl cat in a sample of 100 (<span class="math inline">\(\widehat{p}_{100}\)</span> = 1%).</p></li>
<li class="fragment"><p>Now, it is <em>possible</em> that the <em>Quora</em> claim is true and we just happened to get <em>extraordinarily</em> lucky (or unlucky).</p></li>
<li class="fragment"><p>But, it’s probably more likely that we should start to question the validity of the <em>Quora</em> statistic.</p></li>
</ul>
</section>
<section id="hypothesis-testing-1" class="slide level2">
<h2><i class="fa-solid fa-magnifying-glass-chart" aria-label="magnifying-glass-chart"></i> Hypothesis Testing</h2>
<h3 id="general-framework">General Framework</h3>
<ul>
<li class="fragment"><p>So where’s the cutoff - how many polydactyl cats do we need to observe in a sample of <em>n</em> before we start to question the <em>Quora</em> statistic?</p></li>
<li class="fragment"><p>This is the general framework of <span class="alert"><strong>hypothesis testing</strong></span>.</p></li>
<li class="fragment"><p>We start off with a pair of competing claims, called the <span class="alert"><strong>null hypothesis</strong></span> and the <span class="alert"><strong>alternative hypothesis</strong></span>.</p>
<ul>
<li class="fragment">The null hypothesis is usually set to be the “status quo”. For instance, in our polydactyly example, we would set the null hypothesis (denoted <em>H</em><sub>0</sub>, and read “H-naught”) to be “10% of cats are polydactyl.”</li>
<li class="fragment">We’ll discuss the choice of alternative in a bit.</li>
</ul></li>
</ul>
</section>
<section id="hypothesis-testing-2" class="slide level2">
<h2><i class="fa-solid fa-magnifying-glass-chart" aria-label="magnifying-glass-chart"></i> Hypothesis Testing</h2>
<h3 id="tests-for-the-mean">Tests for the Mean</h3>
<ul>
<li class="fragment"><p>We’ve only covered testing for the <em>mean</em> in this class, so let’s stick with that for today.</p></li>
<li class="fragment"><p>Our null takes the form <strong>H<sub>0</sub></strong>: <em>µ</em> = <em>µ</em><sub>0</sub> for some prespecified value <em>µ</em><sub>0</sub> (e.g.&nbsp;“the true average weight of all cats is 9.5 lbs;” then <em>µ</em><sub>0</sub> = 9.5).</p></li>
<li class="fragment"><p>There are three main choices for an alternative:</p>
<ul>
<li class="fragment"><span class="alert"><strong>Lower-Tailed</strong></span>: <strong>H<sub>A</sub></strong>: <em>µ</em> &lt; <em>µ</em><sub>0</sub></li>
<li class="fragment"><span class="alert"><strong>Upper-Tailed</strong></span>: <strong>H<sub>A</sub></strong>: <em>µ</em> &gt; <em>µ</em><sub>0</sub></li>
<li class="fragment"><span class="alert"><strong>Two-Tailed</strong></span> (aka <span class="alert"><strong>Two-Sided</strong></span>): <strong>H<sub>A</sub></strong>: <em>µ</em> ≠ <em>µ</em><sub>0</sub></li>
</ul></li>
</ul>
</section>
<section id="hypothesis-testing-3" class="slide level2">
<h2><i class="fa-solid fa-magnifying-glass-chart" aria-label="magnifying-glass-chart"></i> Hypothesis Testing</h2>
<h3 id="some-notes">Some notes</h3>
<ul>
<li class="fragment">Note: It is <span class="alert"><strong>ABSOLUTELY CRUCIAL</strong></span> that there is no overlap between the null and the alternative.
<ul>
<li class="fragment">For example, it would be <em>incorrect</em> to write a lower-tailed alternative as <strong>H<sub>A</sub></strong>: <em>µ</em> ≤ <em>µ</em><sub>0</sub></li>
<li class="fragment">Conceptually, this is because we need the alternative to be a true <em>alternative</em> to the null; i.e.&nbsp;we cannot have a case where the null and alternative are simultaneously true</li>
</ul></li>
<li class="fragment">Also, to stress, we only ever pick <em>one</em> alternative; on the previous slide I’ve listed the <em>possible</em> alternatives, but it’s up to you (or the problem statement) to pick one.</li>
</ul>
</section>
<section id="states-of-the-world" class="slide level2">
<h2><i class="fa-solid fa-scale-unbalanced" aria-label="scale-unbalanced"></i> States of the World</h2>
<ul>
<li class="fragment"><p>In a given hypothesis testing setting, the null is either true or not (though we won’t ever get to know for sure).</p></li>
<li class="fragment"><p>Independently, our test will either reject the null or not.</p></li>
<li class="fragment"><p>This leads to four states of the world:</p></li>
</ul>
<div class="fragment">
<table>
<tbody><tr>
<td style="border: 0px solid black;">
</td>
<td style="border: 0px solid black;">
</td>
<td colspan="2" padding-left:10px;="" background-color:="" #c4eef2;="" style="text-align: center"><b>Result of Test</b></td>
</tr>
<tr>
<td style="border: 0px solid black;">
</td>
<td style="border: 0px solid black;">
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; width:5cm; text-align: center">
<b>Reject</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; width:5cm; text-align: center">
<b>Fail to Reject</b>
</td>
</tr>
<tr>
<td style="border: 0px solid black; text-align: center; vertical-align: middle;" rowspan="2">
<b><i>H</i><sub>0</sub></b>
</td>
<td style="border: 0px solid black;">
<b>True</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:red">
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center">
</td>
</tr>
<tr>
<td style="border: 0px solid black;">
<b>False</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center">
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center">
</td>
</tr>
</tbody></table>
</div>
<ul>
<li class="fragment">Some of these states are good, others are bad. Which are which?</li>
</ul>
</section>
<section id="states-of-the-world-1" class="slide level2">
<h2><i class="fa-solid fa-scale-unbalanced" aria-label="scale-unbalanced"></i> States of the World</h2>
<table>
<tbody><tr>
<td style="border: 0px solid black;">
</td>
<td style="border: 0px solid black;">
</td>
<td colspan="2" padding-left:10px;="" background-color:="" #c4eef2;="" style="text-align: center"><b>Result of Test</b></td>
</tr>
<tr>
<td style="border: 0px solid black;">
</td>
<td style="border: 0px solid black;">
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; width:5cm; text-align: center">
<b>Reject</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; width:5cm; text-align: center">
<b>Fail to Reject</b>
</td>
</tr>
<tr>
<td style="border: 0px solid black; text-align: center; vertical-align: middle;" rowspan="2">
<b><i>H</i><sub>0</sub></b>
</td>
<td style="border: 0px solid black;">
<b>True</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:red">
<b>BAD</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:green">
<b>GOOD</b>
</td>
</tr>
<tr>
<td style="border: 0px solid black;">
<b>False</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:green">
<b>GOOD</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:red">
<b>BAD</b>
</td>
</tr>
</tbody></table>
<ul>
<li class="fragment">We give names to the two “bad” situations: <strong>Type I</strong> and <strong>Type II</strong> errors.</li>
</ul>
<div class="fragment">
<table>
<tbody><tr>
<td style="border: 0px solid black;">
</td>
<td style="border: 0px solid black;">
</td>
<td colspan="2" padding-left:10px;="" background-color:="" #c4eef2;="" style="text-align: center"><b>Result of Test</b></td>
</tr>
<tr>
<td style="border: 0px solid black;">
</td>
<td style="border: 0px solid black;">
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; width:5cm; text-align: center">
<b>Reject</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; width:5cm; text-align: center">
<b>Fail to Reject</b>
</td>
</tr>
<tr>
<td style="border: 0px solid black; text-align: center; vertical-align: middle;" rowspan="2">
<b><i>H</i><sub>0</sub></b>
</td>
<td style="border: 0px solid black;">
<b>True</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:red">
<b>Type I Error</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:green">
<b>GOOD</b>
</td>
</tr>
<tr>
<td style="border: 0px solid black;">
<b>False</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:green">
<b>GOOD</b>
</td>
<td style="border: 1px solid black; padding-right:10px;  padding-left:10px; text-align:center; color:red">
<b>Type II Error</b>
</td>
</tr>
</tbody></table>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Definition:</strong> Type I and Type II errors</strong></p>
</div>
<div class="callout-content">
<div>
<div style="font-size: 25px">
<ul>
<li>A <span class="alert"><strong>Type I Error</strong></span> occurs when we reject <span class="math inline">\(H_0\)</span>, when <span class="math inline">\(H_0\)</span> was actually true.</li>
<li>A <span class="alert"><strong>Type II Error</strong></span> occurs when we fail to reject <span class="math inline">\(H_0\)</span>, when <span class="math inline">\(H_0\)</span> was actually false.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="states-of-the-world-2" class="slide level2">
<h2><i class="fa-solid fa-scale-unbalanced" aria-label="scale-unbalanced"></i> States of the World</h2>
<h3 id="type-i-and-type-ii-errors">Type I and Type II Errors</h3>
<ul>
<li class="fragment"><p>A common way of interpreting Type I and Type II errors are in the context of the judicial system.</p></li>
<li class="fragment"><p>The US judicial system is built upon a motto of “innocent until proven guilty.” As such, the null hypothesis is that a given person is innocent.</p></li>
<li class="fragment"><p>A Type I error represents convicting an innocent person; a Type II error represents letting a guilty person go free.</p></li>
<li class="fragment"><p>Tradeoff: If we want to reduce the number of times we wrongfully convict an innocent person, we may want to make the conditions for convicting someone even stronger. But, this would have the consequence of having fewer people overall convicted, thereby (and inadvertently) <em>increasing</em> the chance we let a guilty person go free</p>
<ul>
<li class="fragment"><u>Controlling for one type of error increses the likelihood of committing the other type.</u></li>
</ul></li>
</ul>
</section>
<section id="states-of-the-world-3" class="slide level2">
<h2><i class="fa-solid fa-scale-unbalanced" aria-label="scale-unbalanced"></i> States of the World</h2>
<h3 id="type-i-and-type-ii-errors-1">Type I and Type II Errors</h3>
<ul>
<li class="fragment">Define <span class="math inline">\(\alpha\)</span> to be the probability of committing a Type I error.</li>
<li class="fragment">Define <span class="math inline">\(\beta(\theta_A)\)</span> to be the probability of committing a Type II error when the true value of the parameter was <span class="math inline">\(\theta_A\)</span>.</li>
<li class="fragment">Define <span class="math inline">\(Q(\theta_A)\)</span> to be the probability of rejecting the null, when the true value of the paramer is <span class="math inline">\(\theta_A\)</span>.
<ul>
<li class="fragment">Called the <span class="alert"><strong>power function</strong></span>, or just <span class="alert"><strong>power</strong></span>, of the test.</li>
</ul></li>
<li class="fragment">When performing hypothesis testing, we start by fixing <span class="math inline">\(\alpha\)</span> (which we call the <span class="alert"><strong>level</strong></span>, or <span class="alert"><strong>significance level</strong></span>, of our test), and then minimize <span class="math inline">\(\beta(\theta)\)</span> subject to this fixed level <span class="math inline">\(\alpha\)</span>.</li>
</ul>
</section>
<section id="example-1" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 1</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Example 1</strong></strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(Y_1, \cdots, Y_n \iid \mathcal{N}(\mu, 1)\)</span> for some unknown <em>µ</em>, and suppose we wish to test <strong>H<sub>0</sub></strong>: <em>µ</em> = <em>µ</em><sub>0</sub> vs <strong>H<sub>A</sub></strong>: <em>µ</em> &gt; <em>µ</em><sub>0</sub> at a 0.05 level of significance. We propose two tests:</p>
<div>
<ul>
<li><strong>Test 1:</strong> Reject <strong>H<sub>0</sub></strong> when <span class="math inline">\(Y_1 - \mu_0 &gt; \Phi^{-1}(0.95)\)</span></li>
<li><strong>Test 2:</strong> Reject <strong>H<sub>0</sub></strong> when <span class="math inline">\(\frac{\overline{Y}_n - \mu_0}{1/\sqrt{n}} &gt; \Phi^{-1}(0.95)\)</span></li>
</ul>
</div>
<div>
<ol type="a">
<li>Verify that both tests have a 5% level of significance.</li>
<li>Derive expressions for the power functions of both tests.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="example-1-2" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 1</h2>
<h3 id="part-a">Part (a)</h3>
<ul>
<li class="fragment"><p>Let’s focus on Test 1.</p></li>
<li class="fragment"><p>By definition, the level of the test is the probability of rejecting the null when the null was true.</p></li>
<li class="fragment"><p>Saying that “the null was true” is saying that the true value of <em>µ</em> is <em>µ</em><sub>0</sub>, in which case <span class="math inline">\(Y_1 \sim \mathcal{N}(\mu_0, 1)\)</span>.</p></li>
<li class="fragment"><p>Hence, the probability of rejecting the null (i.e.&nbsp;that <span class="math inline">\(Y_1 - \mu_0 &gt; \Phi^{-1}(0.95)\)</span>) if the null is true is:</p></li>
</ul>
<div class="fragment" style="font-size:28px">
<p><span class="math display">\[\begin{align*}
  \Prob_{H_0}(Y_1 - \mu_0 &gt; \Phi^{-1}(0.95)) &amp; = 1 - \Prob_{H_0}(Y_1 - \mu_0 \leq \Phi^{-1}(0.95)) \\
    &amp; = 1 - \Phi[\Phi^{-1}(0.95)] = 1 - 0.95 = 0.05 \ \checkmark
\end{align*}\]</span></p>
</div>
<ul>
<li class="fragment">Try Test 2 on your own.</li>
</ul>
</section>
<section id="example-1-3" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 1</h2>
<h3 id="part-b">Part (b)</h3>
<ul>
<li class="fragment"><p>We now turn our attention to the power curves. Again, we start with Test 1.</p></li>
<li class="fragment"><p><em>Q</em>(<em>µ</em><sub>A</sub>) is the probability of rejecting the null when the true value of <em>µ</em> is in fact <em>µ</em><sub>A</sub>.</p></li>
<li class="fragment"><p>Saying that “the true value of <em>µ</em> is in fact <em>µ</em><sub>A</sub>” means <span class="math inline">\(Y_1 \sim \mathcal{N}(\mu_A, 1)\)</span>. Furthermore, we reject the null when <span class="math inline">\(Y_1 &gt; \Phi^{-1}(0.95)\)</span>.</p></li>
<li class="fragment"><p>Hence,</p></li>
</ul>
</section>
<section id="example-3" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 3</h2>
<h3 id="part-b-1">Part (b)</h3>
<div class="fragment" style="font-size:28px">
<p><span class="math display">\[\begin{align*}
  Q_1(\mu_A) &amp; = \Prob_{\mu_A}(Y_1 - \mu_0 &gt; \Phi^{-1}(0.95)) \\
  &amp;  = \Prob_{\mu_A}(Y_1 - {\color{blue} \mu_A + \mu_A} -  \mu_0 &gt; \Phi^{-1}(0.95)) \\
   &amp;  = \Prob_{\mu_A}({\color{red}Y_1 - \mu_A} &gt; \Phi^{-1}(0.95) + (\mu_0 - \mu_A)) \\
   &amp;  = 1 - \Phi[\Phi^{-1}(0.95) + (\mu_0 - \mu_A)]
\end{align*}\]</span></p>
</div>
<ul>
<li class="fragment">For test 2:</li>
</ul>
<div class="fragment" style="font-size:28px">
<p><span class="math display">\[\begin{align*}
  Q_2(\mu_A) &amp; = \Prob_{\mu_A}\left(\frac{\overline{Y}_n - {\color{blue} \mu_A + \mu_A} - \mu_0}{1/\sqrt{n}} &gt; \Phi^{-1}(0.95) \right) \\
  &amp; = \cdots = 1 - \Phi\left[\Phi^{-1}(0.95) + \sqrt{n}(\mu_0 - \mu_A) \right]
\end{align*}\]</span></p>
</div>
</section>
<section id="example-3-1" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 3</h2>
<h3 id="part-b-2">Part (b)</h3>

<img data-src="finrev_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="estimation" class="title-slide slide level1 center" data-background-color="black" data-background-image="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExbjg2emEyamwxMGFvemt4MWh5dHMxNjQ3YXFxbzE4czNlbTlwbXU4cCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xT5LMUajJOsjtdPAgU/giphy.gif" data-background-size="100rem">
<h1>Estimation</h1>

</section>
<section id="estimation-1" class="slide level2">
<h2><i class="fa-solid fa-sign-hanging" aria-label="sign-hanging"></i> Estimation</h2>
<h3 id="general-framework-1">General Framework</h3>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li class="fragment"><p>We have a <span class="alert"><strong>population</strong></span>, governed by a set of <span class="alert"><strong>population parameters</strong></span> that are unobserved (but that we’d like to make claims about).</p></li>
<li class="fragment"><p>To make claims about the population parameters, we take a <span class="alert"><strong>sample</strong></span>.</p></li>
<li class="fragment"><p>We then use our sample to make <span class="alert"><strong>inferences</strong></span> (i.e.&nbsp;claims) about the population parameters.</p></li>
</ul>
</div><div class="column" style="width:40%;">
<div class="fragment">
<p><img data-src="images/Inference.svg"></p>
</div>
</div></div>
<ul>
<li class="fragment">Inference can mean either <span class="alert"><strong>estimation</strong></span> or <span class="alert"><strong>hypothesis testing</strong></span>.</li>
</ul>
</section>
<section id="estimation-2" class="slide level2">
<h2><i class="fa-solid fa-sign-hanging" aria-label="sign-hanging"></i> Estimation</h2>
<h3 id="terminology">Terminology</h3>
<ul>
<li class="fragment"><p>In estimation, we seek to estimate a particular population parameter.</p></li>
<li class="fragment"><p>We do so by taking a sample (<em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em></sub>) from the population, and constructing an <span class="alert"><strong>estimator</strong></span>: <span class="math display">\[ \widehat{\theta}_n := \widehat{\theta}_n(Y_1, \cdots, Y_n) \]</span></p></li>
<li class="fragment"><p>Crucially, an estimator is a <em>random</em> quantity.</p>
<ul>
<li class="fragment">Contrast this with an <span class="alert"><strong>estimate</strong></span>, which we obtain by plugging specific data into our estimator.</li>
<li class="fragment">E.g. we use the <em>sample mean</em> as an estimator for the population mean; after getting a specific set of observations, their numerical sample mean is the estimate.</li>
</ul></li>
</ul>
</section>
<section id="estimation-3" class="slide level2">
<h2><i class="fa-solid fa-sign-hanging" aria-label="sign-hanging"></i> Estimation</h2>
<h3 id="properties">Properties</h3>
<ul>
<li class="fragment">A “good” estimator is one that possesses one (or several) desirable properties, which we can measure in a few different ways:
<ul>
<li class="fragment"><span class="alert"><strong>Unbiasedness</strong></span>: <span class="math inline">\(\E[\widehat{\theta}_n] = \theta\)</span></li>
<li class="fragment"><span class="alert"><strong>Consistency</strong></span>: <span class="math inline">\(\widehat{\theta}_n \probto \theta\)</span></li>
<li class="fragment"><span class="alert"><strong>MVUE</strong></span>: <span class="math inline">\(\widehat{\theta}_n\)</span> is unbiased and possesses the smallest variance among all posssible unbiased estimators.</li>
<li class="fragment"><span class="alert"><strong>MSE:</strong></span> <span class="math inline">\(\mathrm{MSE}(\widehat{\theta}_n) = \mathrm{Bias}^2(\widehat{\theta}_n) + \Var(\widehat{\theta}_n)\)</span>
<ul>
<li class="fragment"><strong>Question:</strong> do we want high or low MSE?</li>
</ul></li>
<li class="fragment"><span class="alert"><strong>Efficiency</strong></span>: <span class="math inline">\(\widehat{\theta}_n\)</span> attains the Cramér-Rao Lower Bound</li>
</ul></li>
</ul>
</section>
<section id="estimation-4" class="slide level2">
<h2><i class="fa-solid fa-sign-hanging" aria-label="sign-hanging"></i> Estimation</h2>
<h3 id="constructing-estimators">Constructing Estimators</h3>
<ul>
<li class="fragment"><p>Most of this is from before the midterm.</p></li>
<li class="fragment"><p>After the midterm, we asked ourselves: how can we <em>construct</em> estimators?</p></li>
<li class="fragment"><p>There are two main methods we use:</p>
<ul>
<li class="fragment">The <span class="alert"><strong>Method of Moments</strong></span> (MoM)</li>
<li class="fragment">The method of <span class="alert"><strong>Maximum Likelihood Estimation</strong></span> (MLE)</li>
</ul></li>
<li class="fragment"><p>Intuition behind the method of moments: our sample moments should closely match the population moments (the sample average cat weight should probably be close to the true average of all cat weights).</p></li>
</ul>
</section>
<section id="method-of-moments" class="slide level2">
<h2><i class="fa-solid fa-sign-hanging" aria-label="sign-hanging"></i> Method of Moments</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Method of Moments</strong></strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li class="fragment"><p>Set up <em>p</em> equations (where <em>p</em> is the number of parameters that are desired to be estimated) of the form <span class="math display">\[\begin{align*}
  M_1   &amp;= \mu_1 \\
  M_2   &amp; = \mu_2  \\
  \vdots &amp; \hspace{5mm} \vdots \\
  M_p   &amp; = \mu_p
\end{align*}\]</span> where <span class="math display">\[ M_k := \frac{1}{n} \sum_{i=1}^{n} Y_i^k ; \qquad \mu_k := \E[Y_i^k] \]</span> denote the <em>k</em><sup>th</sup> <span class="alert"><strong>sample moment</strong></span> and <span class="alert"><strong>population moment</strong></span>, respectively</p></li>
<li class="fragment"><p>Solve the equations for the <em>p</em> parameters; these will be the method of moments estimators for the parameters.</p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="example-2" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 2</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Example 1</strong></strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(Y_1, \cdots, Y_n \iid \mathrm{Geom}(p)\)</span>. Derive an expression for <span class="math inline">\(\widehat{p}_{\mathrm{MoM}}\)</span>, the method of moments estimator for <em>p</em>.</p>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>We have only one parameter, so we only need to set up one equation.</p></li>
<li class="fragment"><p>The first population moment is given by <span class="math inline">\(\mu_1 := \E[Y_i] = 1/p\)</span></p></li>
<li class="fragment"><p>Hence, our method of moments estimator satisfies the equation <span class="math display">\[ \overline{Y}_n = \frac{1}{\widehat{p}_{\mathrm{MoM}}} \]</span></p></li>
<li class="fragment"><p>When solved for <span class="math inline">\(\widehat{p}_{\mathrm{MoM}}\)</span>, we obtain <span class="math inline">\(\boxed{\widehat{p}_{\mathrm{MoM}} = \frac{1}{\overline{Y}_n}}\)</span></p></li>
</ul>
</section>
<section id="sampling" class="slide level2">
<h2><i class="fa-solid fa-vial" aria-label="vial"></i> Sampling</h2>
<h3 id="example-cats">Example: Cats!</h3>

<img data-src="Images/Sampling0.svg" class="r-stretch"></section>
<section id="sampling-1" class="slide level2">
<h2><i class="fa-solid fa-vial" aria-label="vial"></i> Sampling</h2>
<h3 id="example-cats-1">Example: Cats!</h3>

<img data-src="Images/Sampling1.svg" class="r-stretch"></section>
<section id="sampling-2" class="slide level2">
<h2><i class="fa-solid fa-vial" aria-label="vial"></i> Sampling</h2>
<h3 id="example-cats-2">Example: Cats!</h3>

<img data-src="Images/Sampling2.svg" class="r-stretch"></section>
<section id="sampling-3" class="slide level2">
<h2><i class="fa-solid fa-vial" aria-label="vial"></i> Sampling</h2>
<h3 id="example-cats-3">Example: Cats!</h3>

<img data-src="Images/Sampling3.svg" class="r-stretch"></section>
<section id="leadup" class="slide level2">
<h2><i class="fa-solid fa-stairs" aria-label="stairs"></i> Leadup</h2>
<ul>
<li class="fragment"><p>Each one of these samples provides some information about <em>µ</em>, the true average weight of all cats.</p></li>
<li class="fragment"><p>For example, suppose we only observed the first sample: <span class="math display">\[ \vec{\boldsymbol{y}} = (8.5, \ 12.0, \ 7.5, \ 11.1, ... , \ 8.8, 10.4) \]</span></p>
<ul>
<li class="fragment">For reference, the average weight of cats in this sample is 9.11 lbs.</li>
</ul></li>
<li class="fragment"><p>Given this sample, how likely do we think it is that the true average weight of all cats is, say, 8 lbs?</p></li>
<li class="fragment"><p>Given this sample, how likely do we think it is that the true average weight of all cats is, say, 30 lbs?</p></li>
<li class="fragment"><p>Given this sample, how likely do we think it is that the true average weight of all cats is, say, some arbitrary value <em>µ</em>?</p></li>
</ul>
</section>
<section id="likelihoods" class="slide level2">
<h2><i class="fa-solid fa-dice" aria-label="dice"></i> Likelihoods</h2>
<ul>
<li class="fragment"><p>The answer to this last question is precisely the <span class="alert"><strong>likelihood</strong></span> of a sample.</p></li>
<li class="fragment"><p>More generally, <span class="math display">\[ \Lik(\theta; Y_1, \cdots, Y_n) \]</span> denotes the likelihood of the true value of the parameter being θ, given observations (<em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em></sub>).</p></li>
<li class="fragment"><p>Mathematically, the likelihood is just the joint density function of (<em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em></sub>); conceptually, we are now viewing it as a function of θ.</p></li>
<li class="fragment"><p>As a concrete example, suppose <span class="math inline">\(Y_1, \cdots, Y_n \iid \mathcal{N}(\mu, 1)\)</span> (if it helps, you can think of these at cat weights).</p></li>
</ul>
</section>
<section id="likelihoods-1" class="slide level2">
<h2><i class="fa-solid fa-dice" aria-label="dice"></i> Likelihoods</h2>
<h3 id="example">Example</h3>
<ul>
<li class="fragment">Since our sample is stated to be i.i.d., <span class="math display">\[\begin{align*}
  \Lik(\theta; Y_1, \cdots, Y_n)  &amp; := f_{Y_1, \cdots, Y_n}(y_1, \cdots, y_n ; \theta) \\
&amp; = \prod_{i=1}^{n} f_{Y_i}(y_i; \theta)  \\
&amp; = \prod_{i=1}^{n} \left[ \frac{1}{\sqrt{2\pi}} \exp\left\{ - \frac{1}{2} (Y_i - \mu)^2 \right\} \right] \\
&amp; = \left( \frac{1}{2\pi} \right)^{n/2} \cdot \exp\left\{ - \frac{1}{2} \sum_{i=1}^{n} (\mu - Y_i)^2 \right\}
\end{align*}\]</span></li>
</ul>
</section>
<section id="likelihoods-2" class="slide level2">
<h2><i class="fa-solid fa-dice" aria-label="dice"></i> Likelihoods</h2>
<h3 id="example-4">Example</h3>

<img data-src="finrev_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="likelihoods-3" class="slide level2">
<h2><i class="fa-solid fa-dice" aria-label="dice"></i> Likelihoods</h2>
<h3 id="example-5">Example</h3>

<img data-src="finrev_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section id="likelihoods-4" class="slide level2">
<h2><i class="fa-solid fa-dice" aria-label="dice"></i> Likelihoods</h2>
<h3 id="example-6">Example</h3>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Caution</strong></strong></p>
</div>
<div class="callout-content">
<p>Though it hasn’t always been explicitly stated, there are <em>two</em> types of likelihoods we’ve been dealing with.</p>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>On the one hand, we have the likelihood of an <em>entire sample</em> (<em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em></sub>)</p>
<ul>
<li class="fragment">This is what we discussed above.</li>
</ul></li>
<li class="fragment"><p>On the other hand, we can also talk about the likelihood of a <em>single observation</em> <em>Y</em><sub><em>i</em></sub>.</p></li>
<li class="fragment"><p>Though we can call both a “likelihood,” they differ in notation: <span class="math inline">\(\Lik(\theta; Y_1, \cdots, Y_n)\)</span> vs <span class="math inline">\(\Lik(\theta; Y_i)\)</span>.</p></li>
<li class="fragment"><p>This distinction will become important later.</p></li>
</ul>
</section>
<section id="maximum-likelihood-estimation" class="slide level2">
<h2><i class="fa-solid fa-sign-hanging" aria-label="sign-hanging"></i> Maximum Likelihood Estimation</h2>
<ul>
<li class="fragment"><p>Consider again the likelihood of a sample; <span class="math inline">\(\Lik(\theta; Y_1, \cdots, Y_n)\)</span>.</p></li>
<li class="fragment"><p>Recall that this represents how likely any specified value of θ is to be the truth, given the data (<em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em></sub>).</p></li>
<li class="fragment"><p>A good guess for the true value of θ, therefore, is perhaps the one that was <em>most</em> likely to have been the case, given the data we observed.</p>
<ul>
<li class="fragment">In other words, the value that <em>maximizes</em> the likelihood.</li>
</ul></li>
</ul>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Definition:</strong> <span class="alert"><strong>Maximum Likelihood Estimator</strong></span></strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[ \widehat{\theta}_{\mathrm{MLE}} := \argmax_{\theta} \left\{ \Lik(\theta; Y_1, \cdots, Y_n) \right\} \]</span></p>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">Sometimes it’s more convenient to work with the <span class="alert"><strong>log-likelihood</strong></span>, though it is not always necessary.</li>
</ul>
</section>
<section id="example-3-2" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 3</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Example 3</strong></strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(Y_1, \cdots, Y_n \iid \mathcal{N}(\mu, 1)\)</span>. Derive an expression for <span class="math inline">\(\widehat{\mu}_{\mathrm{MLE}}\)</span>, the maximum likelihood estimator for <em>µ</em>.</p>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>We already found the likelihood above.</p></li>
<li class="fragment"><p>The log-likelihood is given by <span class="math display">\[ \ell(\mu; Y_1, \cdots, Y_n) = -\frac{n}{2} \ln(2\pi) - \frac{1}{2} \sum_{i=1}^{n}(Y_i - \mu)^2 \]</span></p></li>
<li class="fragment"><p>The <span class="alert"><strong>score function</strong></span> is given by <span class="math display">\[ \frac{\partial}{\partial \mu} \ell(\theta; Y_1, \cdots, Y_n) = \sum_{i=1}^{n} (Y_i - \mu) = n \overline{Y}_n - n \mu\]</span></p></li>
</ul>
</section>
<section id="example-2-1" class="slide level2">
<h2><i class="fa-solid fa-pencil" aria-label="pencil"></i> Example 2</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Example 2</strong></strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(Y_1, \cdots, Y_n \iid \mathcal{N}(\mu, 1)\)</span>. Derive an expression for <span class="math inline">\(\widehat{\mu}_{\mathrm{MLE}}\)</span>, the maximum likelihood estimator for <em>µ</em>.</p>
</div>
</div>
</div>
<div>
<ul>
<li>Setting this equal to zero and solving for <em>µ</em> reveals that a critical value of the likelihood is given by <span class="math inline">\(\mu = \overline{Y}_n\)</span>.</li>
</ul>
</div>
<ul>
<li class="fragment"><p>The second derivative of the log-likelihood is given by <span class="math display">\[\frac{\partial^2}{\partial \mu^2} \ell(\theta; Y_1, \cdots, Y_n) = - n \]</span> which is negative everywhere; hence the critical value we found above must be a maximum.</p></li>
<li class="fragment"><p>Thus, <span class="math inline">\(\boxed{\widehat{\mu}_{\mathrm{MLE}} = \overline{Y}_n}\)</span></p></li>
</ul>
</section>
<section id="maximum-likelihood-estimation-1" class="slide level2">
<h2><i class="fa-solid fa-sign-hanging" aria-label="sign-hanging"></i> Maximum Likelihood Estimation</h2>
<ul>
<li class="fragment"><p>If the support of the population distribution depends on the parameter of interest, the likelihood will be nondifferentiable (with respect to the parameter of interest).</p></li>
<li class="fragment"><p>In such cases, the likelihood must be maximized by inspection - there’s an example of this on the worksheet we’ll go over later today.</p></li>
</ul>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Theorem</strong></strong></p>
</div>
<div class="callout-content">
<p>Under regularity, <span class="math display">\[ Z := \frac{t(\widehat{\theta}_n) - t(\theta)}
{\sqrt{ \left. \left[\frac{\partial t(\theta)}{\partial \theta} \right]^2 \middle/   \mathcal{I}_n(\theta) \right.}}  \rightsquigarrow \mathcal{N}(0, 1)\]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="fisher-information" class="slide level2">
<h2><i class="fa-solid fa-info" aria-label="info"></i> Fisher Information</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Definition:</strong> <span class="alert"><strong>Fisher Information</strong></span></strong></p>
</div>
<div class="callout-content">
<p>Under regularity, the <span class="alert"><strong>Fisher Information</strong></span> of a sample (<em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em></sub>) is given by <span class="math display">\[ \mathcal{I}_n(\theta) = - \E\left[ \frac{\partial^2}{\partial \theta^2} \ell(\theta; Y_1, \cdots, Y_n) \right] \]</span></p>
<p>Under regularity, the <span class="alert"><strong>Fisher Information</strong></span> of an observation <em>Y</em><sub><em>i</em></sub> <span class="math display">\[ \mathcal{I}_1(\theta) = - \E\left[ \frac{\partial^2}{\partial \theta^2} \ell(\theta; Y_i) \right] \]</span></p>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Theorem</strong></strong></p>
</div>
<div class="callout-content">
<p>Assuming an i.i.d. sample, <span class="math display">\[ \mathcal{I}_n(\theta) = n \mathcal{I}_1(\theta) \]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="fisher-information-1" class="slide level2">
<h2><i class="fa-solid fa-info" aria-label="info"></i> Fisher Information</h2>
<ul>
<li class="fragment"><p>I highlight this because I know it can be confusing at times why we sometimes multiply by <em>n</em> and sometimes do not.</p></li>
<li class="fragment"><p>The reason for this is, again, the difference between the likelihood for a <em>sample</em> and the likelihood for a <em>single observation</em>.</p></li>
<li class="fragment"><p>For example, to find the asymptotic variance of the MLE, we can either:</p>
<ul>
<li class="fragment">Find the Fisher Information of a single observation and multiply by <em>n</em></li>
<li class="fragment">Find the Fisher Information of the sample and <em>not</em> multiply by <em>n</em></li>
<li class="fragment">The second approach will typically involve dealing with sums/products; the first will not (but you will have to remember to multiply by <em>n</em> in the end).</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="two-sample-confidence-intervals" class="title-slide slide level1 center" data-background-color="black" data-background-image="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExazA0ODVhOW1uam5jcjJ3OXc4a2UzY290M3M1eDNwczUxeHQ2MW1maSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/l2JdTZL6GzeFgKhyg/giphy.gif" data-background-size="70rem">
<h1>Two-Sample Confidence Intervals</h1>

</section>
<section id="leadup-1" class="slide level2">
<h2><i class="fa-solid fa-stairs" aria-label="stairs"></i> Leadup</h2>
<ul>
<li class="fragment"><p>Do UCSB students have, on average, the same commute times as SBCC students?</p></li>
<li class="fragment"><p>We assume we have two samples, (<em>X</em><sub>1</sub>, …, <em>X</em><sub><em>n</em><sub><em>x</em></sub></sub>) and (<em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em><sub><em>y</em></sub></sub>) from two normal distributions, with means <em>µ</em><sub><em>x</em></sub> and <em>µ</em><sub><em>y</em></sub>, respectively.</p>
<ul>
<li class="fragment">For example, the <em>X</em>’s might represent UCSB commute times and the <em>Y</em>’s might represent SBCC commute times.</li>
</ul></li>
<li class="fragment"><p>To construct a confidence interval for (<em>µ</em><sub><em>x</em></sub> - <em>µ</em><sub><em>y</em></sub>), we just need to plug into one of the formulas from the Week 8 Part 2 slide deck; the only question is <em>which one</em>?</p></li>
<li class="fragment"><p>The answer depends on the assumptions we make (or the problem tells us to make).</p></li>
</ul>
</section>
<section id="confidence-interval-for-a-difference-in-means" class="slide level2">
<h2><i class="fa-solid fa-cash-register" aria-label="cash-register"></i> Confidence Interval for a Difference in Means</h2>
<ul>
<li class="fragment"><p><strong>Population Variances:</strong> are the population variances assumed to be the same?</p>
<ul>
<li class="fragment">E.g. are the variances among <em>all</em> UCSB commute times the same as the variances among <em>all</em> SBCC commute times?</li>
<li class="fragment">Note; this isn’t the same as checking whether the <em>sample</em> variances are equal!</li>
</ul></li>
<li class="fragment"><p>If we assume they are the same, we first <strong>pool</strong> the sample variances and then use the <em>z</em>-distribution to construct our CI.</p></li>
<li class="fragment"><p>If we assume they are different, we <strong>do not pool</strong> the sample variances, and use the <em>t</em>-distribution.</p>
<ul>
<li class="fragment">The degrees of freedom is taken to be the minimum of (<em>n</em><sub><em>x</em></sub> - 1) and (<em>n</em><sub><em>y</em></sub> - 1).</li>
</ul></li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="Images/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>PSTAT 120B Sp25; Final Exam Review, © Ethan P. Marzban</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="finrev_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="finrev_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="finrev_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="finrev_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"17491368868433532369","id":"4d41fc3ee3aa0bfb","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>